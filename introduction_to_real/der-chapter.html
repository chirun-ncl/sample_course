<!doctype html>
<html lang="en">
    <head>
        
            <meta charset="utf-8">
            <meta name="robots" content="noindex">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <meta name="author" content="Ann Example" />
            <meta name="date" content="2021-12-02" />
        

        <title>The Derivative | Sample Course</title>

        
    
    
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../static/styles.css">
            <link rel="stylesheet" id="customiseCSS" href="../static/light.css">
            
            
        
    <link rel="stylesheet" id="customiseCodeCSS" href="../static/pygmentize.light.css">
    <link rel="stylesheet" href="../static/codemirror-5.26.0/lib/codemirror.css">
    <link rel="stylesheet" href="../static/boole.css">
    <link rel="stylesheet" href="../static/numbasEmbed.css">

    <link rel="stylesheet" href="../static/bootstrap-toc.css?v=3">
    <link rel="stylesheet" href="../static/print.css">


        
    
    
            <script defer src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
            <script defer src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
            <script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
            <script defer src="../static/mathjax_config.js"></script>
            <script type="text/javascript" id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
            <script defer src="../static/customisation.js"></script>
            <script defer src="../static/mp4.js"></script>
            
            
        
    <script defer src="../static/jquery.flexibleArea.js"></script>
    <script defer src="../static/spin.min.js"></script>
    <script defer src="../static/codemirror-5.26.0/lib/codemirror.js"></script>
    <script defer src="../static/codemirror-5.26.0/mode/octave/octave.js"></script>
    <script defer src="../static/codemirror-5.26.0/mode/python/python.js"></script>
    <script defer src="../static/codemirror-5.26.0/mode/r/r.js"></script>
    <script defer src="../static/boole.js"></script>
    <script defer src="../static/numbasEmbed.js"></script>

    <script defer src="../static/bootstrap-toc.js"></script>

    </head>
    <body data-spy="scroll" data-target="#chapterTOC" data-offset="50">
        
<div class="collapse" id="navbarToggleCustomise">
	<div class="bg-secondary text-white p-3">
		<form onsubmit="return false;" id="navbarCustomise">
			<div class="form-row">
				<label>Theme Customisation</label>
				<div id="themeSelector" class="form-group col-md-12">
					<button class="btn btn-dark mr-2" value="dark">Dark</button>
					<button class="btn btn-pastel mr-2" value="pastel">Pastel</button>
					<button class="btn btn-light mr-4" value="light">Light</button>
				</div>
			</div>
			<div class="form-row">
				<div class="form-group col-md-4">
					<label style="display: block" for="font-scale">Font size (<span id="font-size-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="font-scale" min="50" max="600" value="100">
					<button id="font-scale-reset" class="btn btn-sm">Reset</button>
				</div>
				<div class="form-group col-md-4">
					<label style="display: block" for="p-space">Spacing (<span id="p-space-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="p-space" min="0" max="600" value="100">
					<button id="p-space-reset" class="btn btn-sm">Reset</button>
				</div>
			</div>
		</form>
	</div>
</div>

<nav aria-label="breadcrumb">
	<ul class="breadcrumb">
		<li class="breadcrumb-item">
			<a href="../index.html">Sample Course</a>
		</li>
		
		<li class="breadcrumb-item">
			<a href="../introduction_to_real/index.html">Introduction to Real Analysis</a>
		</li>
		
		<li class="breadcrumb-item active">
			The Derivative
		</li>
		<li class="ml-auto">
			<button class="navbar-toggler p0" type="button" data-toggle="collapse" data-target="#navbarToggleCustomise" aria-controls="navbarToggleCustomise" aria-expanded="false" aria-label="Toggle customisations panel">
				<i class="fa fa-cog" aria-hidden="true" title="Toggle customisations panel"></i> <span class="sr-only">Toggle customisations panel</span>
			</button>
		</li>
	</ul>
</nav>


        <header>
            
            
        </header>
        <main>
            
    <div class="container mt-3">
        <div class="row">
            
            <div id="sidebar" class="col-md-3">
                <nav class="mb-3" id="chapterTOC" data-toggle="toc">
                    <ul class="nav navbar-nav">
                        
                        
                        
                        <li><a id="pdf-link" class="nav-link" href="../introduction_to_real/pdf/the_derivative.pdf" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true" title="Download as PDF"></i>&nbsp;Download as PDF</a></li>
                        
                    </ul>
                </nav>
            </div>
            <div id="content" class="col-md-9"> 
            
            <!-- Latex Chapter/Part -->
<h1 id="der:chapter">The Derivative</h1>
<section class="section">
<h2 id="sec:der">4.1 The derivative</h2>
<p>
The idea of a derivative is the following. If the graph of a function looks locally like a straight line, then we can then talk about the slope of this line. The slope tells us the rate at which the value of the function is changing at that particular point. Of course, we are leaving out any function that has corners or discontinuities. Let us be precise. 
</p>
<section class="subsection">
<h3 id="a0000000821">4.1.1 Definition and basic properties</h3>
<p>
<div class="thmwrapper defn_thmwrapper" id="a0000000822">
<div class="thmheading defn_thmheading">
<span class="thmcaption defn_thmcaption">
    Definition
    </span>
<span class="thmlabel defn_thmlabel">4.1</span>
</div>
<div class="thmcontent defn_thmcontent">
<p>
Let <script type="math/tex">I</script> be an interval, let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> be a function, and let <script type="math/tex">c \in I</script>. If the limit 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  L := \lim _{x \to c} \frac{f(x)-f(c)}{x-c} \end{equation*}</script></span>
<p>
 exists, then we say <script type="math/tex">f</script> is <em>differentiable</em><a id="a0000000823" name="a0000000823"></a> at <script type="math/tex">c</script>, that <script type="math/tex">L</script> is the <em>derivative</em> of <script type="math/tex">f</script> at <script type="math/tex">c</script>, and write <script type="math/tex">f'(c) := L</script>. 
</p>
<p>
If <script type="math/tex">f</script> is differentiable at all <script type="math/tex">c \in I</script>, then we simply say that <script type="math/tex">f</script> is <em>differentiable</em>, and then we obtain a function <script type="math/tex">f' \colon I \to {\mathbb {R}}</script>. The derivative is sometimes written as <script type="math/tex">\frac{df}{dx}</script> or <script type="math/tex">\frac{d}{dx}\bigl ( f(x) \bigr )</script>. 
</p>
<p>
The expression <script type="math/tex">\frac{f(x)-f(c)}{x-c}</script> is called the <em>difference quotient</em>. 
</p>
</div>
</div>
</p>
<p>
The graphical interpretation of the derivative is depicted in <a href="#.">Figure <span>4.1</span></a>. The left-hand plot gives the line through <script type="math/tex">\bigl (c,f(c)\bigr )</script> and <script type="math/tex">\bigl (x,f(x)\bigr )</script> with slope <script type="math/tex">\frac{f(x)-f(c)}{x-c}</script>, that is, the so-called <em>secant line</em>. When we take the limit as <script type="math/tex">x</script> goes to <script type="math/tex">c</script>, we get the right-hand plot, where we see that the derivative of the function at the point <script type="math/tex">c</script> is the slope of the line tangent to the graph of <script type="math/tex">f</script> at the point <script type="math/tex">\bigl (c,f(c)\bigr )</script>. 
</p>
<p>
<figure id="derivfig">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0055.png" style="None"/>
   	<img src="../introduction_to_real/images/img-0057.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.1</span> <span class="caption_text">Graphical interpretation of the derivative.</span>
</figcaption>
</div>
</figure>
</p>
<p>
We allow <script type="math/tex">I</script> to be a closed interval and we allow <script type="math/tex">c</script> to be an endpoint of <script type="math/tex">I</script>. Some calculus books do not allow <script type="math/tex">c</script> to be an endpoint of an interval, but all the theory still works by allowing it, and it makes our work easier. 
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000824">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">4.2</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
Let <script type="math/tex">f(x) := x^2</script> defined on the whole real line. Let <script type="math/tex">c \in {\mathbb {R}}</script> be arbitrary. We find that if <script type="math/tex">x \not=c</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{x^2-c^2}{x-c} = \frac{(x+c)(x-c)}{x-c} = (x+c) . \end{equation*}</script></span>
<p>
 Therefore, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f’(c) = \lim _{x\to c} \frac{x^2-c^2}{x-c} = \lim _{x\to c} (x+c) = 2c. \end{equation*}</script></span>
</div>
</div>
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000825">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">4.3</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
Let <script type="math/tex">f(x) := ax + b</script> for numbers <script type="math/tex">a, b \in {\mathbb {R}}</script>. Let <script type="math/tex">c \in {\mathbb {R}}</script> be arbitrary. For <script type="math/tex">x \not=c</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{f(x)-f(c)}{x-c} = \frac{a(x-c)}{x-c} = a . \end{equation*}</script></span>
<p>
 Therefore, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f’(c) = \lim _{x\to c} \frac{f(x)-f(c)}{x-c} = \lim _{x\to c} a = a. \end{equation*}</script></span>
<p>
 In fact, every differentiable function “infinitesimally” behaves like the affine function <script type="math/tex">ax + b</script>. You can guess many results and formulas for derivatives, if you work them out for affine functions first. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000826">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">4.4</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
The function <script type="math/tex">f(x) := \sqrt{x}</script> is differentiable for <script type="math/tex">x > 0</script>. To see this fact, fix <script type="math/tex">c > 0</script>, and take <script type="math/tex">x \not= c</script>, <script type="math/tex">x > 0</script>. Compute 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{\sqrt{x}-\sqrt{c}}{x-c} = \frac{\sqrt{x}-\sqrt{c}}{(\sqrt{x}-\sqrt{c})(\sqrt{x}+\sqrt{c})} = \frac{1}{\sqrt{x}+\sqrt{c}} . \end{equation*}</script></span>
<p>
 Therefore, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f’(c) = \lim _{x\to c} \frac{\sqrt{x}-\sqrt{c}}{x-c} = \lim _{x\to c} \frac{1}{\sqrt{x}+\sqrt{c}} = \frac{1}{2\sqrt{c}} . \end{equation*}</script></span>
</div>
</div>
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000827">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">4.5</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
The function <script type="math/tex">f(x) := \left\lvert {x} \right\rvert </script> is not differentiable at the origin. When <script type="math/tex">x > 0</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{\left\lvert {x} \right\rvert -\left\lvert {0} \right\rvert }{x-0} = \frac{x-0}{x-0} = 1 . \end{equation*}</script></span>
<p>
 When <script type="math/tex">x < 0</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{\left\lvert {x} \right\rvert -\left\lvert {0} \right\rvert }{x-0} = \frac{-x-0}{x-0} = -1 . \end{equation*}</script></span>
</div>
</div>
</p>
<p>
A famous example of Weierstrass shows that there exists a continuous function that is not differentiable at <em>any</em> point. The construction of this function is beyond the scope of this chapter. On the other hand, a differentiable function is always continuous. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="a0000000828">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.6</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
Let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> be differentiable at <script type="math/tex">c \in I</script>, then it is continuous at <script type="math/tex">c</script>. 
</p>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000829">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We know the limits 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \lim _{x\to c}\frac{f(x)-f(c)}{x-c} = f’(c) \qquad \text{and} \qquad \lim _{x\to c}(x-c) = 0 \end{equation*}</script></span>
<p>
 exist. Furthermore, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(x)-f(c) = \left( \frac{f(x)-f(c)}{x-c} \right) (x-c) . \end{equation*}</script></span>
<p>
 Therefore, the limit of <script type="math/tex">f(x)-f(c)</script> exists and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \lim _{x\to c} \bigl ( f(x)-f(c) \bigr ) = \left(\lim _{x\to c} \frac{f(x)-f(c)}{x-c} \right) \left(\lim _{x\to c} (x-c) \right) = f’(c) \cdot 0 = 0. \end{equation*}</script></span>
<p>
 Hence <script type="math/tex">\lim \limits _{x\to c} f(x) = f(c)</script>, and <script type="math/tex">f</script> is continuous at <script type="math/tex">c</script>. 
</p>
</div>
</div>
<p>
An important property of the derivative is linearity. The derivative is the approximation of a function by a straight line. The slope of a line through two points changes linearly when the <script type="math/tex">y</script>-coordinates are changed linearly. By taking the limit, it makes sense that the derivative is linear. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="a0000000830">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.7</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
<a id="a0000000831" name="a0000000831"></a> Let <script type="math/tex">I</script> be an interval, let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> and <script type="math/tex">g \colon I \to {\mathbb {R}}</script> be differentiable at <script type="math/tex">c \in I</script>, and let <script type="math/tex">\alpha \in {\mathbb {R}}</script>. 
</p>
<ol class="enumerate" id="a0000000832" style="list-style: none">
<li id="a0000000833" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
Define <script type="math/tex">h \colon I \to {\mathbb {R}}</script> by <script type="math/tex">h(x) := \alpha f(x)</script>. Then <script type="math/tex">h</script> is differentiable at <script type="math/tex">c</script> and <script type="math/tex">h'(c) = \alpha f'(c)</script>. 
</p>
</li>
<li id="a0000000834" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
Define <script type="math/tex">h \colon I \to {\mathbb {R}}</script> by <script type="math/tex">h(x) := f(x) + g(x)</script>. Then <script type="math/tex">h</script> is differentiable at <script type="math/tex">c</script> and <script type="math/tex">h'(c) = f'(c) + g'(c)</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000835">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
First, let <script type="math/tex">h(x) := \alpha f(x)</script>. For <script type="math/tex">x \in I</script>, <script type="math/tex">x \not= c</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{h(x)-h(c)}{x-c} = \frac{\alpha f(x) - \alpha f(c)}{x-c} = \alpha \frac{f(x) - f(c)}{x-c} . \end{equation*}</script></span>
<p>
 The limit as <script type="math/tex">x</script> goes to <script type="math/tex">c</script> exists on the right-hand side by <a href="#.">Corollary <span>3.12</span></a>. We get 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \lim _{x\to c}\frac{h(x)-h(c)}{x-c} = \alpha \lim _{x\to c} \frac{f(x) - f(c)}{x-c} . \end{equation*}</script></span>
<p>
 Therefore, <script type="math/tex">h</script> is differentiable at <script type="math/tex">c</script>, and the derivative is computed as given. 
</p>
<p>
Next, define <script type="math/tex">h(x) := f(x)+g(x)</script>. For <script type="math/tex">x \in I</script>, <script type="math/tex">x \not= c</script>, we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{h(x)-h(c)}{x-c} = \frac{\bigl (f(x) + g(x)\bigr ) - \bigl (f(c) + g(c)\bigr )}{x-c} = \frac{f(x) - f(c)}{x-c} + \frac{g(x) - g(c)}{x-c} . \end{equation*}</script></span>
<p>
 The limit as <script type="math/tex">x</script> goes to <script type="math/tex">c</script> exists on the right-hand side by <a href="#.">Corollary <span>3.12</span></a>. We get 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \lim _{x\to c}\frac{h(x)-h(c)}{x-c} = \lim _{x\to c} \frac{f(x) - f(c)}{x-c} + \lim _{x\to c}\frac{g(x) - g(c)}{x-c} . \end{equation*}</script></span>
<p>
 Therefore, <script type="math/tex">h</script> is differentiable at <script type="math/tex">c</script>, and the derivative is computed as given. 
</p>
</div>
</div>
<p>
It is not true that the derivative of a multiple of two functions is the multiple of the derivatives. Instead we get the so-called <em>product rule</em> or the <em>Leibniz rule</em><a class="footnote" href="#a0000000836">
<sup class="footnotemark">1</sup>
</a>. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="a0000000837">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.8</span>
<span class="thmtitle prop_thmtitle">(Product rule)</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
<a id="a0000000838" name="a0000000838"></a> Let <script type="math/tex">I</script> be an interval, let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> and <script type="math/tex">g \colon I \to {\mathbb {R}}</script> be functions differentiable at <script type="math/tex">c</script>. If <script type="math/tex">h \colon I \to {\mathbb {R}}</script> is defined by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  h(x) := f(x) g(x) , \end{equation*}</script></span>
<p>
 then <script type="math/tex">h</script> is differentiable at <script type="math/tex">c</script> and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  h’(c) = f(c) g’(c) + f’(c) g(c) . \end{equation*}</script></span>
</div>
</div>
</p>
<p>
The proof of the product rule is left as an exercise. The key to the proof is the identity <script type="math/tex">f(x) g(x) - f(c) g(c) = f(x)\bigl ( g(x) - g(c) \bigr ) + \bigl ( f(x) - f(c) \bigr ) g(c)</script>, which is illustrated in <a href="#.">Figure <span>4.2</span></a>. <figure id="figprodrule">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0059.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.2</span> <span class="caption_text">The idea of product rule. The area of the entire rectangle <script type="math/tex">f(x)g(x)</script> differs from the area of the white rectangle <script type="math/tex">f(c)g(c)</script> by the area of the lightly shaded rectangle <script type="math/tex">f(x)\bigl ( g(x) - g(c) \bigr )</script> plus the darker rectangle <script type="math/tex">\bigl ( f(x) - f(c) \bigr ) g(c)</script>. In other words, <script type="math/tex">\Delta (f \cdot g) = f \cdot \Delta g + \Delta f \cdot g</script>.</span>
</figcaption>
</div>
</figure>
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="a0000000839">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.9</span>
<span class="thmtitle prop_thmtitle">(Quotient Rule)</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
<a id="a0000000840" name="a0000000840"></a> Let <script type="math/tex">I</script> be an interval, let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> and <script type="math/tex">g \colon I \to {\mathbb {R}}</script> be differentiable at <script type="math/tex">c</script> and <script type="math/tex">g(x) \not= 0</script> for all <script type="math/tex">x \in I</script>. If <script type="math/tex">h \colon I \to {\mathbb {R}}</script> is defined by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  h(x) := \frac{f(x)}{g(x)}, \end{equation*}</script></span>
<p>
 then <script type="math/tex">h</script> is differentiable at <script type="math/tex">c</script> and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  h’(c) = \frac{f'(c) g(c) - f(c) g'(c)}{{\bigl (g(c)\bigr )}^2} . \end{equation*}</script></span>
</div>
</div>
</p>
<p>
Again, the proof is left as an exercise. 
</p>
</section><section class="subsection">
<h3 id="a0000000841">4.1.2 Chain rule</h3>
<p>
More complicated functions are often obtained by composition, which is differentiated via the chain rule. The rule also tells us how a derivative changes if we change variables. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="a0000000842">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.10</span>
<span class="thmtitle prop_thmtitle">(Chain Rule)</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
<a id="a0000000843" name="a0000000843"></a> Let <script type="math/tex">I_1, I_2</script> be intervals, let <script type="math/tex">g \colon I_1 \to I_2</script> be differentiable at <script type="math/tex">c \in I_1</script>, and <script type="math/tex">f \colon I_2 \to {\mathbb {R}}</script> be differentiable at <script type="math/tex">g(c)</script>. If <script type="math/tex">h \colon I_1 \to {\mathbb {R}}</script> is defined by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  h(x) := (f \circ g) (x) = f\bigl (g(x)\bigr ) , \end{equation*}</script></span>
<p>
 then <script type="math/tex">h</script> is differentiable at <script type="math/tex">c</script> and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  h’(c) = f’\bigl (g(c)\bigr )g’(c) . \end{equation*}</script></span>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000844">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
Let <script type="math/tex">d := g(c)</script>. Define <script type="math/tex">u \colon I_2 \to {\mathbb {R}}</script> and <script type="math/tex">v \colon I_1 \to {\mathbb {R}}</script> by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  u(y) := \begin{cases}  \frac{f(y) - f(d)}{y-d} &  \text{if } y \not=d, \\ f’(d) &  \text{if } y = d, \end{cases} \qquad v(x) := \begin{cases}  \frac{g(x) - g(c)}{x-c} &  \text{if } x \not=c, \\ g’(c) &  \text{if } x = c. \end{cases}\end{equation*}</script></span>
<p>
 Because <script type="math/tex">f</script> is differentiable at <script type="math/tex">d = g(c)</script>, we find that <script type="math/tex">u</script> is continuous at <script type="math/tex">d</script>. Similarly, <script type="math/tex">v</script> is continuous at <script type="math/tex">c</script>. For any <script type="math/tex">x</script> and <script type="math/tex">y</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(y)-f(d) = u(y) (y-d) \qquad \text{and} \qquad g(x)-g(c) = v(x) (x-c) . \end{equation*}</script></span>
<p>
 Plug in to obtain 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  h(x)-h(c) = f\bigl (g(x)\bigr )-f\bigl (g(c)\bigr ) = u\bigl ( g(x) \bigr ) \bigl (g(x)-g(c)\bigr ) = u\bigl ( g(x) \bigr ) \bigl (v(x) (x-c)\bigr ) . \end{equation*}</script></span>
<p>
 Therefore, if <script type="math/tex">x \not= c</script>, 
</p>
<div class="eqn" id="eq:chainruleeq">
<script type="math/tex; mode=display">\begin{equation}\label{eq:chainruleeq} \frac{h(x)-h(c)}{x-c} = u\bigl ( g(x) \bigr ) v(x) .\tag{4.1}\end{equation}</script>
</div>
<p>
 By continuity of <script type="math/tex">u</script> and <script type="math/tex">v</script> at <script type="math/tex">d</script> and <script type="math/tex">c</script> respectively, we find <script type="math/tex">\lim _{y \to d} u(y) = f'(d) = f'\bigl (g(c)\bigr )</script> and <script type="math/tex">\lim _{x \to c} v(x) = g'(c)</script>. The function <script type="math/tex">g</script> is continuous at <script type="math/tex">c</script>, and so <script type="math/tex">\lim _{x \to c} g(x) = g(c)</script>. Hence the limit of the right-hand side of <a class="ref eqref" href="../introduction_to_real/der-chapter.html#eq:chainruleeq">(4.1)</a> as <script type="math/tex">x</script> goes to <script type="math/tex">c</script> exists and is equal to <script type="math/tex">f'\bigl (g(c)\bigr ) g'(c)</script>. Thus <script type="math/tex">h</script> is differentiable at <script type="math/tex">c</script> and the limit is <script type="math/tex">f'\bigl (g(c)\bigr )g'(c)</script>. 
</p>
</div>
</div>
</section><section class="subsection">
<h3 id="a0000000845">4.1.3 Exercises</h3>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000846">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.1</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Prove the product rule. Hint: Prove and use <script type="math/tex">f(x) g(x) - f(c) g(c) = f(x)\bigl ( g(x) - g(c) \bigr ) + \bigl ( f(x) - f(c) \bigr ) g(c)</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000847">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.2</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Prove the quotient rule. Hint: You can do this directly, but it may be easier to find the derivative of <script type="math/tex">\frac{1}{x}</script> and then use the chain rule and the product rule. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:diffofxn">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.3</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 For <script type="math/tex">n \in {\mathbb {Z}}</script>, prove that <script type="math/tex">x^ n</script> is differentiable and find the derivative, unless, of course, <script type="math/tex">n < 0</script> and <script type="math/tex">x=0</script>. Hint: Use the product rule. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000848">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.4</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Prove that a polynomial is differentiable and find the derivative. Hint: Use the previous exercise. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000849">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.5</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Define <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(x) := \begin{cases}  x^2 &  \text{if } x \in {\mathbb {Q}},\\ 0 &  \text{otherwise.} \end{cases}\end{equation*}</script></span>
<p>
 Prove that <script type="math/tex">f</script> is differentiable at <script type="math/tex">0</script>, but discontinuous at all points except <script type="math/tex">0</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000850">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.6</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Assume the inequality <script type="math/tex">\left\lvert {x-\sin (x)} \right\rvert  \leq x^2</script>. Prove that <script type="math/tex">\sin </script> is differentiable at <script type="math/tex">0</script>, and find the derivative at <script type="math/tex">0</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000851">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.7</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Using the previous exercise, prove that <script type="math/tex">\sin </script> is differentiable at all <script type="math/tex">x</script> and that the derivative is <script type="math/tex">\cos (x)</script>. Hint: Use the sum-to-product trigonometric identity as we did before. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000852">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.8</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> be differentiable. For <script type="math/tex">n \in {\mathbb {Z}}</script>, let <script type="math/tex">f^ n</script> be the function defined by <script type="math/tex">f^ n(x) := {\bigl ( f(x) \bigr )}^ n</script>. If <script type="math/tex">n < 0</script>, assume <script type="math/tex">f(x) \not= 0</script> for all <script type="math/tex">x \in I</script>. Prove that <script type="math/tex">(f^ n)'(x) = n {\bigl (f(x) \bigr )}^{n-1} f'(x)</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000853">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.9</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> is a differentiable Lipschitz continuous function. Prove that <script type="math/tex">f'</script> is a bounded function. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000854">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.10</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Let <script type="math/tex">I_1, I_2</script> be intervals. Let <script type="math/tex">f \colon I_1 \to I_2</script> be a bijective function and <script type="math/tex">g \colon I_2 \to I_1</script> be the inverse. Suppose that both <script type="math/tex">f</script> is differentiable at <script type="math/tex">c \in I_1</script> and <script type="math/tex">f'(c) \not=0</script> and <script type="math/tex">g</script> is differentiable at <script type="math/tex">f(c)</script>. Use the chain rule to find a formula for <script type="math/tex">g'\bigl (f(c)\bigr )</script> (in terms of <script type="math/tex">f'(c)</script>). 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:bndmuldiff">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.11</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Suppose <script type="math/tex">f \colon I \to {\mathbb {R}}</script> is bounded, <script type="math/tex">g \colon I \to {\mathbb {R}}</script> is differentiable at <script type="math/tex">c \in I</script>, and <script type="math/tex">g(c) = g'(c) = 0</script>. Show that <script type="math/tex">h(x) := f(x) g(x)</script> is differentiable at <script type="math/tex">c</script>. Hint: You cannot apply the product rule. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:diffsqueeze">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.12</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Suppose <script type="math/tex">f \colon I \to {\mathbb {R}}</script>, <script type="math/tex">g \colon I \to {\mathbb {R}}</script>, and <script type="math/tex">h \colon I \to {\mathbb {R}}</script>, are functions. Suppose <script type="math/tex">c \in I</script> is such that <script type="math/tex">f(c) = g(c) = h(c)</script>, <script type="math/tex">g</script> and <script type="math/tex">h</script> are differentiable at <script type="math/tex">c</script>, and <script type="math/tex">g'(c) = h'(c)</script>. Furthermore suppose <script type="math/tex">h(x) \leq f(x) \leq g(x)</script> for all <script type="math/tex">x \in I</script>. Prove <script type="math/tex">f</script> is differentiable at <script type="math/tex">c</script> and <script type="math/tex">f'(c) = g'(c) = h'(c)</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000855">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.13</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon (-1,1) \to {\mathbb {R}}</script> is a function such that <script type="math/tex">f(x) = x h(x)</script> for a bounded function <script type="math/tex">h</script>. 
</p>
<ol class="enumerate" id="a0000000856" style="list-style: none">
<li id="a0000000857" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		a)
	</span>
<p>
Show that <script type="math/tex">g(x) := {\bigl ( f(x) \bigr )}^2</script> is differentiable at the origin and <script type="math/tex">g'(0) = 0</script>. 
</p>
</li>
<li id="a0000000858" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		b)
	</span>
<p>
Find an example of a continuous function <script type="math/tex">f \colon (-1,1) \to {\mathbb {R}}</script> with <script type="math/tex">f(0) = 0</script>, but such that <script type="math/tex">g(x) := {\bigl ( f(x) \bigr )}^2</script> is not differentiable at the origin. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000859">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.14</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon I \to {\mathbb {R}}</script> is differentiable at <script type="math/tex">c \in I</script>. Prove there exist numbers <script type="math/tex">a</script> and <script type="math/tex">b</script> with the property that for every <script type="math/tex">\epsilon > 0</script>, there is a <script type="math/tex">\delta > 0</script>, such that <script type="math/tex">\left\lvert {a+b(x-c) - f(x)} \right\rvert  \leq \epsilon \left\lvert {x-c} \right\rvert </script>, whenever <script type="math/tex">x \in I</script> and <script type="math/tex">\left\lvert {x-c} \right\rvert  < \delta </script>. In other words, show that there exists a function <script type="math/tex">g \colon I \to {\mathbb {R}}</script> such that <script type="math/tex">\lim _{x\to c} g(x) = 0</script> and <script type="math/tex">\left\lvert {a+b(x-c) - f(x)} \right\rvert  = g(x) \left\lvert {x-c} \right\rvert </script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:simpleLHopital">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.15</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Prove the following simple version of L’Hôpital’s rule<a id="a0000000860" name="a0000000860"></a>. Suppose <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> and <script type="math/tex">g \colon (a,b) \to {\mathbb {R}}</script> are differentiable functions whose derivatives <script type="math/tex">f'</script> and <script type="math/tex">g'</script> are continuous functions. Suppose that at <script type="math/tex">c \in (a,b)</script>, <script type="math/tex">f(c) = 0</script>, <script type="math/tex">g(c)=0</script>, <script type="math/tex">g'(x) \not= 0</script> for all <script type="math/tex">x \in (a,b)</script>, and <script type="math/tex">g(x) \not= 0</script> whenever <script type="math/tex">x \not= c</script>. Note that the limit of <script type="math/tex">\frac{f'(x)}{g'(x)}</script> as <script type="math/tex">x</script> goes to <script type="math/tex">c</script> exists. Show that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \lim _{x \to c} \frac{f(x)}{g(x)} = \lim _{x \to c} \frac{f'(x)}{g'(x)} . \end{equation*}</script></span>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000861">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.16</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> is differentiable at <script type="math/tex">c \in (a,b)</script>, <script type="math/tex">f(c)=0</script>, and <script type="math/tex">f'(c) > 0</script>. Prove that there is a <script type="math/tex">\delta > 0</script> such that <script type="math/tex">f(x) < 0</script> whenever <script type="math/tex">c-\delta < x < c</script> and <script type="math/tex">f(x) > 0</script> whenever <script type="math/tex">c < x < c+\delta </script>. 
</p>
</div>
</div>
</p>
<p>
<br/>
</p>
</section>
</section><section class="section">
<h2 id="sec:mvt">4.2 Mean value theorem</h2>
<section class="subsection">
<h3 id="a0000000862">4.2.1 Relative minima and maxima</h3>
<p>
We talked about absolute maxima and minima. These are the tallest peaks and lowest valleys in the whole mountain range. What about peaks of individual mountains and bottoms of individual valleys? The derivative, being a local concept, is like walking around in a fog; it can’t tell you if you’re on the highest peak, but it can help you find all the individual peaks. 
</p>
<p>
<div class="thmwrapper defn_thmwrapper" id="a0000000863">
<div class="thmheading defn_thmheading">
<span class="thmcaption defn_thmcaption">
    Definition
    </span>
<span class="thmlabel defn_thmlabel">4.11</span>
</div>
<div class="thmcontent defn_thmcontent">
<p>
Let <script type="math/tex">S \subset {\mathbb {R}}</script> be a set and let <script type="math/tex">f \colon S \to {\mathbb {R}}</script> be a function. The function <script type="math/tex">f</script> is said to have a <em>relative maximum</em><a id="a0000000864" name="a0000000864"></a> at <script type="math/tex">c \in S</script> if there exists a <script type="math/tex">\delta >0</script> such that for all <script type="math/tex">x \in S</script> where <script type="math/tex">\left\lvert {x-c} \right\rvert  < \delta </script>, we have <script type="math/tex">f(x) \leq f(c)</script>. The definition of <em>relative minimum</em><a id="a0000000865" name="a0000000865"></a> is analogous. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="relminmax:lemma">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">4.12</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
 Suppose <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> is differentiable at <script type="math/tex">c \in (a,b)</script>, and <script type="math/tex">f</script> has a relative minimum or a relative maximum at <script type="math/tex">c</script>. Then <script type="math/tex">f'(c) = 0</script>. 
</p>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000866">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We prove the statement for a maximum. For a minimum the statement follows by considering the function <script type="math/tex">-f</script>. 
</p>
<p>
Let <script type="math/tex">c</script> be a relative maximum of <script type="math/tex">f</script>. That is, there is a <script type="math/tex">\delta > 0</script> such that as long as <script type="math/tex">\left\lvert {x-c} \right\rvert  < \delta </script>, we have <script type="math/tex">f(x)-f(c) \leq 0</script>. We look at the difference quotient. If <script type="math/tex">c < x < c+\delta </script>, then 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{f(x)-f(c)}{x-c} \leq 0 , \end{equation*}</script></span>
<p>
 and if <script type="math/tex">c-\delta < y < c</script>, then 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{f(y)-f(c)}{y-c} \geq 0 . \end{equation*}</script></span>
<p>
 See <a href="#.">Figure <span>4.3</span></a> for an illustration. <figure id="fig:critpt">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0061.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.3</span> <span class="caption_text">Slopes of secants at a relative maximum.</span>
</figcaption>
</div>
</figure>
</p>
<p>
As <script type="math/tex">a < c < b</script>, there exist sequences <script type="math/tex">\{  x_ n\} </script> and <script type="math/tex">\{  y_ n \} </script> in <script type="math/tex">[a,b]</script> and within <script type="math/tex">\delta </script> of <script type="math/tex">c</script>, such that <script type="math/tex">x_ n > c</script>, and <script type="math/tex">y_ n < c</script> for all <script type="math/tex">n \in {\mathbb {N}}</script>, and such that <script type="math/tex">\lim \,  x_ n = \lim \,  y_ n = c</script>. Since <script type="math/tex">f</script> is differentiable at <script type="math/tex">c</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  0 \geq \lim _{n\to \infty } \frac{f(x_ n)-f(c)}{x_ n-c} = f’(c) = \lim _{n\to \infty } \frac{f(y_ n)-f(c)}{y_ n-c} \geq 0. \qedhere \end{equation*}</script></span>
</div>
</div>
<p>
For a differentiable function, a point where <script type="math/tex">f'(c) = 0</script> is called a <em>critical point</em>. When <script type="math/tex">f</script> is not differentiable at some points, it is common to also say that <script type="math/tex">c</script> is a critical point if <script type="math/tex">f'(c)</script> does not exist. The theorem says that a relative minimum or maximum at an interior point of an interval must be a critical point. As you remember from calculus, finding minima and maxima of a function can be done by finding all the critical points together with the endpoints of the interval and simply checking at which of these points is the function biggest or smallest. 
</p>
</section><section class="subsection">
<h3 id="a0000000867">4.2.2 Rolle’s theorem</h3>
<p>
Suppose a function has the same value at both endpoints of an interval. Intuitively it ought to attain a minimum or a maximum in the interior of the interval, then at such a minimum or a maximum, the derivative should be zero. See <a href="#.">Figure <span>4.4</span></a> for the geometric idea. This is the content of the so-called Rolle’s theorem<a class="footnote" href="#a0000000868">
<sup class="footnotemark">2</sup>
</a>. 
</p>
<p>
<figure id="rollefig">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0063.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.4</span> <span class="caption_text">Point where the tangent line is horizontal, that is <script type="math/tex">f'(c) = 0</script>.</span>
</figcaption>
</div>
</figure>
</p>
<p>
<div class="thmwrapper thm_thmwrapper" id="thm:rolle">
<div class="thmheading thm_thmheading">
<span class="thmcaption thm_thmcaption">
    Theorem
    </span>
<span class="thmlabel thm_thmlabel">4.13</span>
<span class="thmtitle thm_thmtitle">(Rolle)</span>
</div>
<div class="thmcontent thm_thmcontent">
<p>
<a id="a0000000869" name="a0000000869"></a> Let <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> be continuous function differentiable on <script type="math/tex">(a,b)</script> such that <script type="math/tex">f(a) = f(b)</script>. Then there exists a <script type="math/tex">c \in (a,b)</script> such that <script type="math/tex">f'(c) = 0</script>. 
</p>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000870">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
As <script type="math/tex">f</script> is continuous on <script type="math/tex">[a,b]</script>, it attains an absolute minimum and an absolute maximum in <script type="math/tex">[a,b]</script>. We wish to apply <a href="#.">Lemma <span>4.12</span></a>, and so we need to find some <script type="math/tex">c \in (a,b)</script> where <script type="math/tex">f</script> attains a minimum or a maximum. Write <script type="math/tex">K := f(a) = f(b)</script>. If there exists an <script type="math/tex">x</script> such that <script type="math/tex">f(x) > K</script>, then the absolute maximum is bigger than <script type="math/tex">K</script> and hence occurs at some <script type="math/tex">c \in (a,b)</script>, and therefore <script type="math/tex">f'(c) = 0</script>. On the other hand, if there exists an <script type="math/tex">x</script> such that <script type="math/tex">f(x) < K</script>, then the absolute minimum occurs at some <script type="math/tex">c \in (a,b)</script>, and so <script type="math/tex">f'(c) = 0</script>. If there is no <script type="math/tex">x</script> such that <script type="math/tex">f(x) > K</script> or <script type="math/tex">f(x) < K</script>, then <script type="math/tex">f(x) = K</script> for all <script type="math/tex">x</script> and then <script type="math/tex">f'(x) = 0</script> for all <script type="math/tex">x \in [a,b]</script>, so any <script type="math/tex">c \in (a,b)</script> works. 
</p>
</div>
</div>
<p>
It is absolutely necessary for the derivative to exist for all <script type="math/tex">x \in (a,b)</script>. Consider the function <script type="math/tex">f(x) := \left\lvert {x} \right\rvert </script> on <script type="math/tex">[-1,1]</script>. Clearly <script type="math/tex">f(-1) = f(1)</script>, but there is no point <script type="math/tex">c</script> where <script type="math/tex">f'(c) = 0</script>. 
</p>
</section><section class="subsection">
<h3 id="a0000000871">4.2.3 Mean value theorem</h3>
<p>
We extend <a href="#.">Rolle’s theorem</a> to functions that attain different values at the endpoints. 
</p>
<p>
<div class="thmwrapper thm_thmwrapper" id="thm:mvt">
<div class="thmheading thm_thmheading">
<span class="thmcaption thm_thmcaption">
    Theorem
    </span>
<span class="thmlabel thm_thmlabel">4.14</span>
<span class="thmtitle thm_thmtitle">(Mean value theorem)</span>
</div>
<div class="thmcontent thm_thmcontent">
<p>
<a id="a0000000872" name="a0000000872"></a> Let <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> be a continuous function differentiable on <script type="math/tex">(a,b)</script>. Then there exists a point <script type="math/tex">c \in (a,b)</script> such that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(b)-f(a) = f’(c)(b-a) . \end{equation*}</script></span>
</div>
</div>
</p>
<p>
For a geometric interpretation of the mean value theorem, see <a href="#.">Figure <span>4.5</span></a>. The idea is that the value <script type="math/tex">\frac{f(b)-f(a)}{b-a}</script> is the slope of the line between the points <script type="math/tex">\bigl (a,f(a)\bigr )</script> and <script type="math/tex">\bigl (b,f(b)\bigr )</script>. Then <script type="math/tex">c</script> is the point such that <script type="math/tex">f'(c) = \frac{f(b)-f(a)}{b-a}</script>, that is, the tangent line at the point <script type="math/tex">\bigl (c,f(c)\bigr )</script> has the same slope as the line between <script type="math/tex">\bigl (a,f(a)\bigr )</script> and <script type="math/tex">\bigl (b,f(b)\bigr )</script>. The theorem follows from <a href="#.">Rolle’s theorem</a>, by subtracting from <script type="math/tex">f</script> the affine linear function with the derivative <script type="math/tex">\frac{f(b)-f(a)}{b-a}</script> with the same values at <script type="math/tex">a</script> and <script type="math/tex">b</script> as <script type="math/tex">f</script>. That is, we subtract the function whose graph is the straight line <script type="math/tex">\bigl (a,f(a)\bigr )</script> and <script type="math/tex">\bigl (b,f(b)\bigr )</script>. Then we are looking for a point where this new function has derivative zero. 
</p>
<p>
<figure id="mvtfig">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0065.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.5</span> <span class="caption_text">Graphical interpretation of the mean value theorem.</span>
</figcaption>
</div>
</figure>
</p>
<div class="proof_wrapper" id="a0000000873">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
Define the function <script type="math/tex">g \colon [a,b] \to {\mathbb {R}}</script> by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  g(x) := f(x)-f(b)-\frac{f(b)-f(a)}{b-a}(x-b) . \end{equation*}</script></span>
<p>
 The function <script type="math/tex">g</script> is differentiable on <script type="math/tex">(a,b)</script>, continuous on <script type="math/tex">[a,b]</script>, such that <script type="math/tex">g(a) = 0</script> and <script type="math/tex">g(b) = 0</script>. Thus there exists a <script type="math/tex">c \in (a,b)</script> such that <script type="math/tex">g'(c) = 0</script>, that is, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  0 = g’(c) = f’(c)-\frac{f(b)-f(a)}{b-a} . \end{equation*}</script></span>
<p>
 In other words, <script type="math/tex">f'(c)(b-a) = f(b)-f(a)</script>. 
</p>
</div>
</div>
<p>
The proof generalizes. By considering <script type="math/tex">g(x) := f(x)-f(b)-\frac{f(b)-f(a)}{\varphi (b)-\varphi (a)}\bigl (\varphi (x)-\varphi (b)\bigr )</script>, one can prove the following version. We leave the proof as an exercise. 
</p>
<p>
<div class="thmwrapper thm_thmwrapper" id="thm:cauchymvt">
<div class="thmheading thm_thmheading">
<span class="thmcaption thm_thmcaption">
    Theorem
    </span>
<span class="thmlabel thm_thmlabel">4.15</span>
<span class="thmtitle thm_thmtitle">(Cauchy’s mean value theorem)</span>
</div>
<div class="thmcontent thm_thmcontent">
<p>
<a id="a0000000874" name="a0000000874"></a> Let <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> and <script type="math/tex">\varphi \colon [a,b] \to {\mathbb {R}}</script> be continuous functions differentiable on <script type="math/tex">(a,b)</script>. Then there exists a point <script type="math/tex">c \in (a,b)</script> such that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \bigl (f(b)-f(a)\bigr )\varphi ’(c) = f’(c)\bigl (\varphi (b)-\varphi (a)\bigr ) . \end{equation*}</script></span>
</div>
</div>
</p>
<p>
The mean value theorem has the distinction of being one of the few theorems commonly cited in court. That is, when police measure the speed of cars by aircraft, or via cameras reading license plates, they measure the time the car takes to go between two points. The mean value theorem then says that the car must have somewhere attained the speed you get by dividing the difference in distance by the difference in time. 
</p>
</section><section class="subsection">
<h3 id="a0000000875">4.2.4 Applications</h3>
<p>
We now solve our very first differential equation. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="prop:derzeroconst">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.16</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
 Let <script type="math/tex">I</script> be an interval and let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> be a differentiable function such that <script type="math/tex">f'(x) = 0</script> for all <script type="math/tex">x \in I</script>. Then <script type="math/tex">f</script> is constant. 
</p>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000876">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
Take arbitrary <script type="math/tex">x,y \in I</script> with <script type="math/tex">x < y</script>. As <script type="math/tex">I</script> is an interval, <script type="math/tex">[x,y] \subset I</script>. Then <script type="math/tex">f</script> restricted to <script type="math/tex">[x,y]</script> satisfies the hypotheses of the <a href="#.">mean value theorem</a>. Therefore, there is a <script type="math/tex">c \in (x,y)</script> such that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(y)-f(x) = f’(c)(y-x). \end{equation*}</script></span>
<p>
 As <script type="math/tex">f'(c) = 0</script>, we have <script type="math/tex">f(y) = f(x)</script>. Hence, the function is constant. 
</p>
</div>
</div>
<p>
Now that we know what it means for the function to stay constant, let us look at increasing and decreasing functions. We say <script type="math/tex">f \colon I \to {\mathbb {R}}</script> is <em>increasing</em> (resp.  <em>strictly increasing</em>) if <script type="math/tex">x < y</script> implies <script type="math/tex">f(x) \leq f(y)</script> (resp. <script type="math/tex">f(x) < f(y)</script>). We define <em>decreasing</em> and <em>strictly decreasing</em> in the same way by switching the inequalities for <script type="math/tex">f</script>. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="incdecdiffprop">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.17</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
 Let <script type="math/tex">I</script> be an interval and let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> be a differentiable function. 
</p>
<ol class="enumerate" id="a0000000877" style="list-style: none">
<li id="a0000000878" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
<script type="math/tex">f</script> is increasing if and only if <script type="math/tex">f'(x) \geq 0</script> for all <script type="math/tex">x \in I</script>. 
</p>
</li>
<li id="a0000000879" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
<script type="math/tex">f</script> is decreasing if and only if <script type="math/tex">f'(x) \leq 0</script> for all <script type="math/tex">x \in I</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000880">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
Let us prove the first item. Suppose <script type="math/tex">f</script> is increasing, then for all <script type="math/tex">x,c \in I</script> with <script type="math/tex">x \neq c</script>, we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{f(x)-f(c)}{x-c} \geq 0 . \end{equation*}</script></span>
<p>
 Taking a limit as <script type="math/tex">x</script> goes to <script type="math/tex">c</script> we see that <script type="math/tex">f'(c) \geq 0</script>. 
</p>
<p>
For the other direction, suppose <script type="math/tex">f'(x) \geq 0</script> for all <script type="math/tex">x \in I</script>. Take any <script type="math/tex">x, y \in I</script> where <script type="math/tex">x < y</script>, and note that <script type="math/tex">[x,y] \subset I</script>. By the <a href="#.">mean value theorem</a>, there is some <script type="math/tex">c \in (x,y)</script> such that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(y)-f(x) = f’(c)(y-x) . \end{equation*}</script></span>
<p>
 As <script type="math/tex">f'(c) \geq 0</script>, and <script type="math/tex">y-x > 0</script>, then <script type="math/tex">f(y) - f(x) \geq 0</script> or <script type="math/tex">f(x) \leq f(y)</script> and so <script type="math/tex">f</script> is increasing. 
</p>
<p>
We leave the decreasing part to the reader as exercise. 
</p>
</div>
</div>
<p>
A similar but weaker statement is true for strictly increasing and decreasing functions. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="incdecdiffstrictprop">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.18</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
 Let <script type="math/tex">I</script> be an interval and let <script type="math/tex">f \colon I \to {\mathbb {R}}</script> be a differentiable function. 
</p>
<ol class="enumerate" id="a0000000881" style="list-style: none">
<li id="incdecdiffstrictprop:i" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
 If <script type="math/tex">f'(x) > 0</script> for all <script type="math/tex">x \in I</script>, then <script type="math/tex">f</script> is strictly increasing. 
</p>
</li>
<li id="incdecdiffstrictprop:ii" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
 If <script type="math/tex">f'(x) < 0</script> for all <script type="math/tex">x \in I</script>, then <script type="math/tex">f</script> is strictly decreasing. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
The proof of <a class="ref" href="../introduction_to_real/der-chapter.html#incdecdiffstrictprop:i">1</a> is left as an exercise. Then <a class="ref" href="../introduction_to_real/der-chapter.html#incdecdiffstrictprop:ii">2</a> follows from <a class="ref" href="../introduction_to_real/der-chapter.html#incdecdiffstrictprop:i">1</a> by considering <script type="math/tex">-f</script> instead. The converse of this proposition is not true. The function <script type="math/tex">f(x) := x^3</script> is strictly increasing, but <script type="math/tex">f'(0) = 0</script>. 
</p>
<p>
Another application of the <a href="#.">mean value theorem</a> is the following result about location of extrema, sometimes called the <em>first derivative test</em>. The theorem is stated for an absolute minimum and maximum. To apply it to find relative minima and maxima, restrict <script type="math/tex">f</script> to an interval <script type="math/tex">(c-\delta ,c+\delta )</script>. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="firstderminmaxtest">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.19</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
 Let <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> be continuous. Let <script type="math/tex">c \in (a,b)</script> and suppose <script type="math/tex">f</script> is differentiable on <script type="math/tex">(a,c)</script> and <script type="math/tex">(c,b)</script>. 
</p>
<ol class="enumerate" id="a0000000882" style="list-style: none">
<li id="a0000000883" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
If <script type="math/tex">f'(x) \leq 0</script> for <script type="math/tex">x \in (a,c)</script> and <script type="math/tex">f'(x) \geq 0</script> for <script type="math/tex">x \in (c,b)</script>, then <script type="math/tex">f</script> has an absolute minimum at <script type="math/tex">c</script>. 
</p>
</li>
<li id="a0000000884" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
If <script type="math/tex">f'(x) \geq 0</script> for <script type="math/tex">x \in (a,c)</script> and <script type="math/tex">f'(x) \leq 0</script> for <script type="math/tex">x \in (c,b)</script>, then <script type="math/tex">f</script> has an absolute maximum at <script type="math/tex">c</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000885">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We prove the first item and leave the second to the reader. Take <script type="math/tex">x \in (a,c)</script> and a sequence <script type="math/tex">\{  y_ n\} </script> such that <script type="math/tex">x < y_ n < c</script> for all <script type="math/tex">n</script> and <script type="math/tex">\lim \,  y_ n = c</script>. By the preceding proposition, <script type="math/tex">f</script> is decreasing on <script type="math/tex">(a,c)</script> so <script type="math/tex">f(x) \geq f(y_ n)</script>. As <script type="math/tex">f</script> is continuous at <script type="math/tex">c</script>, we take the limit to get <script type="math/tex">f(x) \geq f(c)</script> for all <script type="math/tex">x \in (a,c)</script>. 
</p>
<p>
Similarly, take <script type="math/tex">x \in (c,b)</script> and <script type="math/tex">\{  y_ n\} </script> a sequence such that <script type="math/tex">c < y_ n < x</script> and <script type="math/tex">\lim \,  y_ n = c</script>. The function is increasing on <script type="math/tex">(c,b)</script> so <script type="math/tex">f(x) \geq f(y_ n)</script>. By continuity of <script type="math/tex">f</script> we get <script type="math/tex">f(x) \geq f(c)</script> for all <script type="math/tex">x \in (c,b)</script>. Thus <script type="math/tex">f(x) \geq f(c)</script> for all <script type="math/tex">x \in (a,b)</script>. 
</p>
</div>
</div>
<p>
The converse of the proposition does not hold. See <a href="#.">Example <span>4.22</span></a> below. 
</p>
<p>
Another often used application of the mean value theorem you have possibly seen in calculus is the following result on differentiability at the end points of an interval. The proof is <a href="#.">Exercise <span>4.29</span></a>. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="prop:endpointderivative">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.20</span>
</div>
<div class="thmcontent prop_thmcontent">
<ol class="enumerate" id="a0000000886" style="list-style: none">
<li id="a0000000887" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
Suppose <script type="math/tex">f \colon [a,b) \to {\mathbb {R}}</script> is continuous, differentiable in <script type="math/tex">(a,b)</script>, and <script type="math/tex">\lim _{x \to a} f'(x) = L</script>. Then <script type="math/tex">f</script> is differentiable at <script type="math/tex">a</script> and <script type="math/tex">f'(a) = L</script>. 
</p>
</li>
<li id="a0000000888" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
Suppose <script type="math/tex">f \colon (a,b] \to {\mathbb {R}}</script> is continuous, differentiable in <script type="math/tex">(a,b)</script>, and <script type="math/tex">\lim _{x \to b} f'(x) = L</script>. Then <script type="math/tex">f</script> is differentiable at <script type="math/tex">b</script> and <script type="math/tex">f'(b) = L</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
In fact, using the extension result <a href="#.">Proposition <span>3.48</span></a>, you do not need to assume that <script type="math/tex">f</script> is defined at the end point. See <a href="#.">Exercise <span>4.30</span></a>. 
</p>
</section><section class="subsection">
<h3 id="a0000000889">4.2.5 Continuity of derivatives and the intermediate value theorem</h3>
<p>
Derivatives of functions satisfy an intermediate value property. 
</p>
<p>
<div class="thmwrapper thm_thmwrapper" id="thm:darboux">
<div class="thmheading thm_thmheading">
<span class="thmcaption thm_thmcaption">
    Theorem
    </span>
<span class="thmlabel thm_thmlabel">4.21</span>
<span class="thmtitle thm_thmtitle">(Darboux)</span>
</div>
<div class="thmcontent thm_thmcontent">
<p>
<a id="a0000000890" name="a0000000890"></a> Let <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> be differentiable. Suppose <script type="math/tex">y \in {\mathbb {R}}</script> is such that <script type="math/tex">f'(a) < y < f'(b)</script> or <script type="math/tex">f'(a) > y > f'(b)</script>. Then there exists a <script type="math/tex">c \in (a,b)</script> such that <script type="math/tex">f'(c) = y</script>. 
</p>
</div>
</div>
</p>
<p>
The proof follows by subtracting <script type="math/tex">f</script> and a linear function with derivative <script type="math/tex">y</script>. The new function <script type="math/tex">g</script> reduces the problem to the case <script type="math/tex">y=0</script>, where <script type="math/tex">g'(a) > 0 > g'(b)</script>. That is, <script type="math/tex">g</script> is increasing at <script type="math/tex">a</script> and decreasing at <script type="math/tex">b</script>, so it must attain a maximum inside <script type="math/tex">(a,b)</script>, where the derivative is zero. See <a href="#.">Figure <span>4.6</span></a>. 
</p>
<p>
<figure id="darbouxthmfig">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0067.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.6</span> <span class="caption_text">Idea of the proof of Darboux theorem.</span>
</figcaption>
</div>
</figure>
</p>
<div class="proof_wrapper" id="a0000000891">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
Suppose <script type="math/tex">f'(a) < y < f'(b)</script>. Define 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  g(x) := yx - f(x) . \end{equation*}</script></span>
<p>
 The function <script type="math/tex">g</script> is continuous on <script type="math/tex">[a,b]</script>, and so <script type="math/tex">g</script> attains a maximum at some <script type="math/tex">c \in [a,b]</script>. 
</p>
<p>
The function <script type="math/tex">g</script> is also differentiable on <script type="math/tex">[a,b]</script>. Compute <script type="math/tex">g'(x) = y-f'(x)</script>. Thus <script type="math/tex">g'(a) > 0</script>. As the derivative is the limit of difference quotients and is positive, there must be some difference quotient that is positive. That is, there must exist an <script type="math/tex">x > a</script> such that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{g(x)-g(a)}{x-a} > 0 , \end{equation*}</script></span>
<p>
 or <script type="math/tex">g(x) > g(a)</script>. Thus <script type="math/tex">g</script> cannot possibly have a maximum at <script type="math/tex">a</script>. Similarly, as <script type="math/tex">g'(b) < 0</script>, we find an <script type="math/tex">x < b</script> (a different <script type="math/tex">x</script>) such that <script type="math/tex">\frac{g(x)-g(b)}{x-b} < 0</script> or that <script type="math/tex">g(x) > g(b)</script>, thus <script type="math/tex">g</script> cannot possibly have a maximum at <script type="math/tex">b</script>. Therefore, <script type="math/tex">c \in (a,b)</script>, and <a href="#.">Lemma <span>4.12</span></a> applies: As <script type="math/tex">g</script> attains a maximum at <script type="math/tex">c</script> we find <script type="math/tex">g'(c) = 0</script> and so <script type="math/tex">f'(c) = y</script>. 
</p>
<p>
Similarly, if <script type="math/tex">f'(a) > y > f'(b)</script>, consider <script type="math/tex">g(x) := f(x)- yx</script>. 
</p>
</div>
</div>
<p>
We have seen already that there exist discontinuous functions that have the intermediate value property. While it is hard to imagine at first, there also exist functions that are differentiable everywhere and the derivative is not continuous. 
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="baddifffunc:example">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">4.22</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
 Let <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> be the function defined by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(x) := \begin{cases}  {\bigl ( x \sin (\frac{1}{x}) \bigr )}^2 &  \text{if } x \not= 0, \\ 0 &  \text{if } x = 0. \end{cases}\end{equation*}</script></span>
<p>
 We claim that <script type="math/tex">f</script> is differentiable everywhere, but <script type="math/tex">f' \colon {\mathbb {R}}\to {\mathbb {R}}</script> is not continuous at the origin. Furthermore, <script type="math/tex">f</script> has a minimum at <script type="math/tex">0</script>, but the derivative changes sign infinitely often near the origin. See <a href="#.">Figure <span>4.7</span></a>. <figure id="fig:nonc1diff">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0069.png" style="None"/>
   	<img src="../introduction_to_real/images/img-0071.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.7</span> <span class="caption_text">A function with a discontinuous derivative. The function <script type="math/tex">f</script> is on the left and <script type="math/tex">f'</script> is on the right. Notice that <script type="math/tex">f(x) \leq x^2</script> on the left graph.</span>
</figcaption>
</div>
</figure>
</p>
<p>
Proof: It is immediate from the definition that <script type="math/tex">f</script> has an absolute minimum at <script type="math/tex">0</script>; we know <script type="math/tex">f(x) \geq 0</script> for all <script type="math/tex">x</script> and <script type="math/tex">f(0) = 0</script>. 
</p>
<p>
The function <script type="math/tex">f</script> is differentiable for <script type="math/tex">x\not=0</script>, and the derivative is <script type="math/tex">2 \sin (\frac{1}{x}) \bigl ( x \sin (\frac{1}{x}) - \cos (\frac{1}{x}) \bigr )</script>. As an exercise, show that for <script type="math/tex">x_ n = \frac{4}{(8n+1)\pi }</script>, we have <script type="math/tex">\lim \,  f'(x_ n) = -1</script>, and for <script type="math/tex">y_ n = \frac{4}{(8n+3)\pi }</script>, we have <script type="math/tex">\lim \,  f'(y_ n) = 1</script>. Hence if <script type="math/tex">f'</script> exists at <script type="math/tex">0</script>, then it cannot be continuous. 
</p>
<p>
Let us show that <script type="math/tex">f'</script> exists at <script type="math/tex">0</script>. We claim that the derivative is zero. In other words, <script type="math/tex">\left\lvert {\frac{f(x)-f(0)}{x-0} - 0} \right\rvert </script> goes to zero as <script type="math/tex">x</script> goes to zero. For <script type="math/tex">x \not= 0</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \left\lvert {\frac{f(x)-f(0)}{x-0} - 0} \right\rvert  = \left\lvert {\frac{x^2 \sin ^2(\frac{1}{x})}{x}} \right\rvert  = \left\lvert {x \sin ^2(\frac{1}{x})} \right\rvert  \leq \left\lvert {x} \right\rvert  . \end{equation*}</script></span>
<p>
 And, of course, as <script type="math/tex">x</script> tends to zero, <script type="math/tex">\left\lvert {x} \right\rvert </script> tends to zero, and hence <script type="math/tex">\left\lvert {\frac{f(x)-f(0)}{x-0} - 0} \right\rvert </script> goes to zero. Therefore, <script type="math/tex">f</script> is differentiable at 0 and the derivative at 0 is 0. A key point in the calculation above is that <script type="math/tex">\left\lvert {f(x)} \right\rvert  \leq x^2</script>, see also Exercises <a class="ref" href="../introduction_to_real/der-chapter.html#exercise:bndmuldiff">4.11</a> and <a class="ref" href="../introduction_to_real/der-chapter.html#exercise:diffsqueeze">4.12</a>. 
</p>
</div>
</div>
</p>
<p>
It is sometimes useful to assume the derivative of a differentiable function is continuous. If <script type="math/tex">f \colon I \to {\mathbb {R}}</script> is differentiable and the derivative <script type="math/tex">f'</script> is continuous on <script type="math/tex">I</script>, then we say <script type="math/tex">f</script> is <em>continuously differentiable</em><a id="a0000000892" name="a0000000892"></a>. It is common to write <script type="math/tex">C^1(I)</script> for the set of continuously differentiable functions on <script type="math/tex">I</script>. 
</p>
</section><section class="subsection">
<h3 id="a0000000893">4.2.6 Exercises</h3>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000894">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.17</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Finish the proof of <a href="#.">Proposition <span>4.17</span></a>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000895">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.18</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Finish the proof of <a href="#.">Proposition <span>4.19</span></a>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:boundeddermeanslip">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.19</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Suppose <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> is a differentiable function such that <script type="math/tex">f'</script> is a bounded function. Prove that <script type="math/tex">f</script> is a Lipschitz continuous function. 
</p>
</div>
</div>
</p>
<p>
<br/> <div class="thmwrapper exercise_thmwrapper" id="a0000000896">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.20</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> is differentiable and <script type="math/tex">c \in [a,b]</script>. Show there exists a sequence <script type="math/tex">\{  x_ n \} </script> converging to <script type="math/tex">c</script>, <script type="math/tex">x_ n \not= c</script> for all <script type="math/tex">n</script>, such that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f’(c) = \lim _{n\to \infty } f’(x_ n). \end{equation*}</script></span>
<p>
 Do note this does <em>not</em> imply that <script type="math/tex">f'</script> is continuous (why?). 
</p>
</div>
</div>
</p>
<p>
<br/> <div class="thmwrapper exercise_thmwrapper" id="a0000000897">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.21</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> is a function such that <script type="math/tex">\left\lvert {f(x)-f(y)} \right\rvert  \leq \left\lvert {x-y} \right\rvert ^2</script> for all <script type="math/tex">x</script> and <script type="math/tex">y</script>. Show that <script type="math/tex">f(x) = C</script> for some constant <script type="math/tex">C</script>. Hint: Show that <script type="math/tex">f</script> is differentiable at all points and compute the derivative. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:posderincr">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.22</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Finish the proof of <a href="#.">Proposition <span>4.18</span></a>. That is, suppose <script type="math/tex">I</script> is an interval and <script type="math/tex">f \colon I \to {\mathbb {R}}</script> is a differentiable function such that <script type="math/tex">f'(x) > 0</script> for all <script type="math/tex">x \in I</script>. Show that <script type="math/tex">f</script> is strictly increasing. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000898">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.23</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> is a differentiable function such that <script type="math/tex">f'(x) \not= 0</script> for all <script type="math/tex">x \in (a,b)</script>. Suppose there exists a point <script type="math/tex">c \in (a,b)</script> such that <script type="math/tex">f'(c) > 0</script>. Prove <script type="math/tex">f'(x) > 0</script> for all <script type="math/tex">x \in (a,b)</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:samediffconst">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.24</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Suppose <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> and <script type="math/tex">g \colon (a,b) \to {\mathbb {R}}</script> are differentiable functions such that <script type="math/tex">f'(x) = g'(x)</script> for all <script type="math/tex">x \in (a,b)</script>, then show that there exists a constant <script type="math/tex">C</script> such that <script type="math/tex">f(x) = g(x) + C</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000899">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.25</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Prove the following version of L’Hôpital’s rule<a id="a0000000900" name="a0000000900"></a>. Suppose <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> and <script type="math/tex">g \colon (a,b) \to {\mathbb {R}}</script> are differentiable functions and <script type="math/tex">c \in (a,b)</script>. Suppose that <script type="math/tex">f(c) = 0</script>, <script type="math/tex">g(c)=0</script>, <script type="math/tex">g'(x) \not= 0</script> when <script type="math/tex">x \not= c</script>, and that the limit of <script type="math/tex">\frac{f'(x)}{g'(x)}</script> as <script type="math/tex">x</script> goes to <script type="math/tex">c</script> exists. Show that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \lim _{x \to c} \frac{f(x)}{g(x)} = \lim _{x \to c} \frac{f'(x)}{g'(x)} . \end{equation*}</script></span>
<p>
 Compare to <a href="#.">Exercise <span>4.15</span></a>. Note: Before you do anything else, prove that <script type="math/tex">g(x) \not= 0</script> when <script type="math/tex">x \not= c</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000901">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.26</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Let <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> be an unbounded differentiable function. Show <script type="math/tex">f' \colon (a,b) \to {\mathbb {R}}</script> is unbounded. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000902">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.27</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Prove the theorem Rolle actually proved in 1691: <em>If <script type="math/tex">f</script> is a polynomial, <script type="math/tex">f'(a) = f'(b) = 0</script> for some <script type="math/tex">a < b</script>, and there is no <script type="math/tex">c \in (a,b)</script> such that <script type="math/tex">f'(c) = 0</script>, then there is at most one root of <script type="math/tex">f</script> in <script type="math/tex">(a,b)</script>, that is at most one <script type="math/tex">x \in (a,b)</script> such that <script type="math/tex">f(x) = 0</script>.</em> In other words, between any two consecutive roots of <script type="math/tex">f'</script> is at most one root of <script type="math/tex">f</script>. Hint: Suppose there are two roots and see what happens. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000903">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.28</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">a,b \in {\mathbb {R}}</script> and <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> is differentiable, <script type="math/tex">f'(x) = a</script> for all <script type="math/tex">x</script>, and <script type="math/tex">f(0) = b</script>. Find <script type="math/tex">f</script> and prove that it is the unique differentiable function with this property. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:endpointderivative">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.29</span>
</div>
<div class="thmcontent exercise_thmcontent">
<ol class="enumerate" id="a0000000904" style="list-style: none">
<li id="a0000000905" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		a)
	</span>
<p>
Prove <a href="#.">Proposition <span>4.20</span></a>. 
</p>
</li>
<li id="a0000000906" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		b)
	</span>
<p>
Suppose <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> is continuous, and suppose <script type="math/tex">f</script> is differentiable everywhere except at <script type="math/tex">c \in (a,b)</script> and <script type="math/tex">\lim _{x \to c} f'(x) = L</script>. Prove that <script type="math/tex">f</script> is differentiable at <script type="math/tex">c</script> and <script type="math/tex">f'(c) = L</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:extendboundedder">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.30</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Suppose <script type="math/tex">f \colon (0,1) \to {\mathbb {R}}</script> is differentiable and <script type="math/tex">f'</script> is bounded. 
</p>
<ol class="enumerate" id="a0000000907" style="list-style: none">
<li id="a0000000908" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		a)
	</span>
<p>
Show that there exists a continuous function <script type="math/tex">g \colon [0,1) \to {\mathbb {R}}</script> such that <script type="math/tex">f(x) = g(x)</script> for all <script type="math/tex">x \not= 0</script>.<br/>Hint: <a href="#.">Proposition <span>3.48</span></a> and <a href="#.">Exercise <span>4.19</span></a>. 
</p>
</li>
<li id="a0000000909" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		b)
	</span>
<p>
Find an example where the <script type="math/tex">g</script> is not differentiable at <script type="math/tex">x=0</script>. <br/>Hint: Consider something based on <script type="math/tex">\sin (\ln x)</script>, and assume you know basic properties of <script type="math/tex">\sin </script> and <script type="math/tex">\ln </script> from calculus. 
</p>
</li>
<li id="a0000000910" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		c)
	</span>
<p>
Instead of assuming that <script type="math/tex">f'</script> is bounded, assume that <script type="math/tex">\lim _{x \to 0} f'(x) = L</script>. Prove that not only does <script type="math/tex">g</script> exist but it is differentiable at <script type="math/tex">0</script> and <script type="math/tex">g'(0) = L</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000911">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.31</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Prove <a href="#.">Theorem <span>4.15</span></a>. 
</p>
</div>
</div>
</p>
<p>
<br/>
</p>
</section>
</section><section class="section">
<h2 id="sec:taylor">4.3 Taylor’s theorem</h2>
<section class="subsection">
<h3 id="a0000000912">4.3.1 Derivatives of higher orders</h3>
<p>
When <script type="math/tex">f \colon I \to {\mathbb {R}}</script> is differentiable, we obtain a function <script type="math/tex">f' \colon I \to {\mathbb {R}}</script>. The function <script type="math/tex">f'</script> is called the <em>first derivative</em> of <script type="math/tex">f</script>. If <script type="math/tex">f'</script> is differentiable, we denote by <script type="math/tex">f'' \colon I \to {\mathbb {R}}</script> the derivative of <script type="math/tex">f'</script>. The function <script type="math/tex">f''</script> is called the <em>second derivative</em> of <script type="math/tex">f</script>.  We similarly obtain <script type="math/tex">f'''</script>, <script type="math/tex">f''''</script>, and so on. With a larger number of derivatives the notation would get out of hand; we denote by <script type="math/tex">f^{(n)}</script> the  <em><script type="math/tex">n</script>th derivative</em><a id="a0000000913" name="a0000000913"></a> of <script type="math/tex">f</script>. 
</p>
<p>
When <script type="math/tex">f</script> possesses <script type="math/tex">n</script> derivatives, we say <script type="math/tex">f</script> is <em><script type="math/tex">n</script> times differentiable</em><a id="a0000000914" name="a0000000914"></a><a id="a0000000915" name="a0000000915"></a>. 
</p>
</section><section class="subsection">
<h3 id="a0000000916">4.3.2 Taylor’s theorem</h3>
<p>
Taylor’s theorem<a class="footnote" href="#a0000000917">
<sup class="footnotemark">3</sup>
</a> is a generalization of the <a href="#.">mean value theorem</a>. Mean value theorem says that up to a small error <script type="math/tex">f(x)</script> for <script type="math/tex">x</script> near <script type="math/tex">x_0</script> can be approximated by <script type="math/tex">f(x_0)</script>, that is 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(x) = f(x_0) + f’(c)(x-x_0), \end{equation*}</script></span>
<p>
 where the “error” is measured in terms of the first derivative at some point <script type="math/tex">c</script> between <script type="math/tex">x</script> and <script type="math/tex">x_0</script>. Taylor’s theorem generalizes this result to higher derivatives. It tells us that up to a small error, any <script type="math/tex">n</script> times differentiable function can be approximated at a point <script type="math/tex">x_0</script> by a polynomial. The error of this approximation behaves like <script type="math/tex">{(x-x_0)}^{n}</script> near the point <script type="math/tex">x_0</script>. To see why this is a good approximation notice that for a big <script type="math/tex">n</script>, <script type="math/tex">{(x-x_0)}^ n</script> is very small in a small interval around <script type="math/tex">x_0</script>. 
</p>
<p>
<div class="thmwrapper defn_thmwrapper" id="a0000000918">
<div class="thmheading defn_thmheading">
<span class="thmcaption defn_thmcaption">
    Definition
    </span>
<span class="thmlabel defn_thmlabel">4.23</span>
</div>
<div class="thmcontent defn_thmcontent">
<p>
For an <script type="math/tex">n</script> times differentiable function <script type="math/tex">f</script> defined near a point <script type="math/tex">x_0 \in {\mathbb {R}}</script>, define the <script type="math/tex">n</script>th order <em>Taylor polynomial</em><a id="a0000000919" name="a0000000919"></a> for <script type="math/tex">f</script> at <script type="math/tex">x_0</script> as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*} \begin{split}  P_ n^{x_0}(x) &  := \sum _{k=0}^ n \frac{f^{(k)}(x_0)}{k!}{(x-x_0)}^ k \\ &  = f(x_0) + f’(x_0)(x-x_0) + \frac{f''(x_0)}{2}{(x-x_0)}^2 + \frac{f^{(3)}(x_0)}{6}{(x-x_0)}^3 + \cdots + \frac{f^{(n)}(x_0)}{n!}{(x-x_0)}^ n . \end{split}\end{equation*}</script></span>
</div>
</div>
</p>
<p>
See <a href="#.">Figure <span>4.8</span></a> for the odd degree Taylor polynomials for the sine function at <script type="math/tex">x_0=0</script>. The even degree terms are all zero, as even derivatives of sine are again a sine, which are zero at the origin. <figure id="fig:taylorsin">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0073.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.8</span> <span class="caption_text">The odd degree Taylor polynomials for the sine function.</span>
</figcaption>
</div>
</figure>
</p>
<p>
Taylor’s theorem says a function behaves like its <script type="math/tex">n</script>th Taylor polynomial. The <a href="#.">mean value theorem</a> is really Taylor’s theorem for the first derivative. 
</p>
<p>
<div class="thmwrapper thm_thmwrapper" id="thm:taylor">
<div class="thmheading thm_thmheading">
<span class="thmcaption thm_thmcaption">
    Theorem
    </span>
<span class="thmlabel thm_thmlabel">4.24</span>
<span class="thmtitle thm_thmtitle">(Taylor)</span>
</div>
<div class="thmcontent thm_thmcontent">
<p>
<a id="a0000000920" name="a0000000920"></a>  Suppose <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> is a function with <script type="math/tex">n</script> continuous derivatives on <script type="math/tex">[a,b]</script> and such that <script type="math/tex">f^{(n+1)}</script> exists on <script type="math/tex">(a,b)</script>. Given distinct points <script type="math/tex">x_0</script> and <script type="math/tex">x</script> in <script type="math/tex">[a,b]</script>, we can find a point <script type="math/tex">c</script> between <script type="math/tex">x_0</script> and <script type="math/tex">x</script> such that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(x)=P_{n}^{x_0}(x)+\frac{f^{(n+1)}(c)}{(n+1)!}{(x-x_0)}^{n+1} . \end{equation*}</script></span>
</div>
</div>
</p>
<p>
The term <script type="math/tex">R_ n^{x_0}(x):=\frac{f^{(n+1)}(c)}{(n+1)!}{(x-x_0)}^{n+1}</script> is called the <em>remainder term</em><a id="a0000000921" name="a0000000921"></a>. This form of the remainder term is called the <em>Lagrange form</em> of the remainder. There are other ways to write the remainder term, but we skip those. Note that <script type="math/tex">c</script> depends on both <script type="math/tex">x</script> and <script type="math/tex">x_0</script>. 
</p>
<div class="proof_wrapper" id="a0000000922">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
Find a number <script type="math/tex">M_{x,x_0}</script> (depending on <script type="math/tex">x</script> and <script type="math/tex">x_0</script>) solving the equation 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(x)=P_{n}^{x_0}(x)+M_{x,x_0}{(x-x_0)}^{n+1} . \end{equation*}</script></span>
<p>
 Define a function <script type="math/tex">g(s)</script> by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  g(s) := f(s)-P_ n^{x_0}(s)-M_{x,x_0}{(s-x_0)}^{n+1} . \end{equation*}</script></span>
<p>
 We compute the <script type="math/tex">k</script>th derivative at <script type="math/tex">x_0</script> of the Taylor polynomial <script type="math/tex">{(P_ n^{x_0})}^{(k)}(x_0) = f^{(k)}(x_0)</script> for <script type="math/tex">k=0,1,2,\ldots ,n</script> (the zeroth derivative of a function is the function itself). Therefore, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  g(x_0) = g’(x_0) = g”(x_0) = \cdots = g^{(n)}(x_0) = 0 . \end{equation*}</script></span>
<p>
 In particular, <script type="math/tex">g(x_0) = 0</script>. On the other hand <script type="math/tex">g(x) = 0</script>. By the <a href="#.">mean value theorem</a> there exists an <script type="math/tex">x_1</script> between <script type="math/tex">x_0</script> and <script type="math/tex">x</script> such that <script type="math/tex">g'(x_1) = 0</script>. Applying the <a href="#.">mean value theorem</a> to <script type="math/tex">g'</script> we obtain that there exists <script type="math/tex">x_2</script> between <script type="math/tex">x_0</script> and <script type="math/tex">x_1</script> (and therefore between <script type="math/tex">x_0</script> and <script type="math/tex">x</script>) such that <script type="math/tex">g''(x_2) = 0</script>. We repeat the argument <script type="math/tex">n+1</script> times to obtain a number <script type="math/tex">x_{n+1}</script> between <script type="math/tex">x_0</script> and <script type="math/tex">x_ n</script> (and therefore between <script type="math/tex">x_0</script> and <script type="math/tex">x</script>) such that <script type="math/tex">g^{(n+1)}(x_{n+1}) = 0</script>. 
</p>
<p>
Let <script type="math/tex">c:=x_{n+1}</script>. We compute the <script type="math/tex">(n+1)</script>th derivative of <script type="math/tex">g</script> to find 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  g^{(n+1)}(s) = f^{(n+1)}(s)-(n+1)!\, M_{x,x_0} . \end{equation*}</script></span>
<p>
 Plugging in <script type="math/tex">c</script> for <script type="math/tex">s</script> we obtain <script type="math/tex">M_{x,x_0} = \frac{f^{(n+1)}(c)}{(n+1)!}</script>, and we are done. 
</p>
</div>
</div>
<p>
In the proof, we have computed <script type="math/tex">{(P_ n^{x_0})}^{(k)}(x_0) = f^{(k)}(x_0)</script> for <script type="math/tex">k=0,1,2,\ldots ,n</script>. Therefore, the Taylor polynomial has the same derivatives as <script type="math/tex">f</script> at <script type="math/tex">x_0</script> up to the <script type="math/tex">n</script>th derivative. That is why the Taylor polynomial is a good approximation to <script type="math/tex">f</script>. Notice how in <a href="#.">Figure <span>4.8</span></a> the Taylor polynomials are reasonably good approximations to the sine near <script type="math/tex">x=0</script>. 
</p>
<p>
We do not necessarily get good approximations by the Taylor polynomial everywhere. Consider expanding the function <script type="math/tex">f(x) := \frac{x}{1-x}</script> around 0, for <script type="math/tex">x < 1</script>, we get the graphs in <a href="#.">Figure <span>4.9</span></a>. The dotted lines are the first, second, and third degree approximations. The dashed line is the 20th degree polynomial, and yet the approximation only seems to get better with the degree for <script type="math/tex">x > -1</script>, and for smaller <script type="math/tex">x</script>, it in fact gets worse. The polynomials are the partial sums of the geometric series <script type="math/tex">\sum _{n=1}^\infty x^ n</script>, and the series only converges on <script type="math/tex">(-1,1)</script>. See the discussion of power series <a href="#.">§<span>2.6</span></a>. 
</p>
<p>
<figure id="fig:taylorgeom">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0075.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.9</span> <span class="caption_text">The function <script type="math/tex">\frac{x}{1-x}</script>, and the Taylor polynomials <script type="math/tex">P_1^0</script>, <script type="math/tex">P_2^0</script>, <script type="math/tex">P_3^0</script> (all dotted), and the polynomial <script type="math/tex">P_{20}^0</script> (dashed).</span>
</figcaption>
</div>
</figure>
</p>
<p>
If <script type="math/tex">f</script> is <em>infinitely differentiable</em><a id="a0000000923" name="a0000000923"></a>, that is, if <script type="math/tex">f</script> can be differentiated any number of times, then we define the <em>Taylor series</em>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \sum _{k=0}^\infty \frac{f^{(k)}(x_0)}{k!}{(x-x_0)}^ k . \end{equation*}</script></span>
<p>
 There is no guarantee that this series converges for any <script type="math/tex">x \not= x_0</script>. And even where it does converge, there is no guarantee that it converges to the function <script type="math/tex">f</script>. Functions <script type="math/tex">f</script> whose Taylor series at every point <script type="math/tex">x_0</script> converges to <script type="math/tex">f</script> in some open interval containing <script type="math/tex">x_0</script> are called <em>analytic functions</em><a id="a0000000924" name="a0000000924"></a>. Most functions one tends to see in practice are analytic. See <a href="#.">Exercise <span>5.54</span></a>, for an example of a non-analytic function. 
</p>
<p>
The definition of derivative says that a function is differentiable if it is locally approximated by a line. We mention in passing that there exists a converse to Taylor’s theorem, which we will neither state nor prove, saying that if a function is locally approximated in a certain way by a polynomial of degree <script type="math/tex">d</script>, then it has <script type="math/tex">d</script> derivatives. 
</p>
<p>
Taylor’s theorem gives us a quick proof of a version of the second derivative test. By a <em>strict relative minimum</em><a id="a0000000925" name="a0000000925"></a> of <script type="math/tex">f</script> at <script type="math/tex">c</script>, we mean that there exists a <script type="math/tex">\delta > 0</script> such that <script type="math/tex">f(x) > f(c)</script> for all <script type="math/tex">x \in (c-\delta ,c+\delta )</script> where <script type="math/tex">x\not=c</script>. A <em>strict relative maximum</em><a id="a0000000926" name="a0000000926"></a> is defined similarly. Continuity of the second derivative is not needed, but the proof is more difficult and is left as an exercise. The proof also generalizes immediately into the <script type="math/tex">n</script>th derivative test, which is also left as an exercise. 
</p>
<p>
<div class="thmwrapper prop_thmwrapper" id="a0000000927">
<div class="thmheading prop_thmheading">
<span class="thmcaption prop_thmcaption">
    Proposition
    </span>
<span class="thmlabel prop_thmlabel">4.25</span>
<span class="thmtitle prop_thmtitle">(Second derivative test)</span>
</div>
<div class="thmcontent prop_thmcontent">
<p>
<a id="a0000000928" name="a0000000928"></a> Suppose <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> is twice continuously differentiable, <script type="math/tex">x_0 \in (a,b)</script>, <script type="math/tex">f'(x_0) = 0</script> and <script type="math/tex">f''(x_0) > 0</script>. Then <script type="math/tex">f</script> has a strict relative minimum at <script type="math/tex">x_0</script>. 
</p>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000929">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
As <script type="math/tex">f''</script> is continuous, there exists a <script type="math/tex">\delta > 0</script> such that <script type="math/tex">f''(c) > 0</script> for all <script type="math/tex">c \in (x_0-\delta ,x_0+\delta )</script>, see <a href="#.">Exercise <span>3.27</span></a>. Take <script type="math/tex">x \in (x_0-\delta ,x_0+\delta )</script>, <script type="math/tex">x \not= x_0</script>. Taylor’s theorem says that for some <script type="math/tex">c</script> between <script type="math/tex">x_0</script> and <script type="math/tex">x</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  f(x) = f(x_0) + f’(x_0) (x-x_0) + \frac{f''(c)}{2}{(x-x_0)}^{2} = f(x_0) + \frac{f''(c)}{2}{(x-x_0)}^{2} . \end{equation*}</script></span>
<p>
 As <script type="math/tex">f''(c) > 0</script>, and <script type="math/tex">{(x-x_0)}^2 > 0</script>, then <script type="math/tex">f(x) > f(x_0)</script>. 
</p>
</div>
</div>
</section><section class="subsection">
<h3 id="a0000000930">4.3.3 Exercises</h3>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000931">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.32</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Compute the <script type="math/tex">n</script>th Taylor polynomial at <script type="math/tex">0</script> for the exponential function. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000932">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.33</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">p</script> is a polynomial of degree <script type="math/tex">d</script>. Given <script type="math/tex">x_0 \in {\mathbb {R}}</script>, show that the <script type="math/tex">d</script>th Taylor polynomial for <script type="math/tex">p</script> at <script type="math/tex">x_0</script> is equal to <script type="math/tex">p</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000933">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.34</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Let <script type="math/tex">f(x) := \left\lvert {x} \right\rvert ^3</script>. Compute <script type="math/tex">f'(x)</script> and <script type="math/tex">f''(x)</script> for all <script type="math/tex">x</script>, but show that <script type="math/tex">f^{(3)}(0)</script> does not exist. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000934">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.35</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> has <script type="math/tex">n</script> continuous derivatives. Show that for every <script type="math/tex">x_0 \in {\mathbb {R}}</script>, there exist polynomials <script type="math/tex">P</script> and <script type="math/tex">Q</script> of degree <script type="math/tex">n</script> and an <script type="math/tex">\epsilon > 0</script> such that <script type="math/tex">P(x) \leq f(x) \leq Q(x)</script> for all <script type="math/tex">x \in [x_0,x_0+\epsilon ]</script> and <script type="math/tex">Q(x)-P(x) = \lambda {(x-x_0)}^ n</script> for some <script type="math/tex">\lambda \geq 0</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000935">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.36</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
If <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> has <script type="math/tex">n+1</script> continuous derivatives and <script type="math/tex">x_0 \in [a,b]</script>, prove <script type="math/tex">\lim \limits _{x\to x_0} \frac{R_ n^{x_0}(x)}{{(x-x_0)}^ n} = 0</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000936">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.37</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon [a,b] \to {\mathbb {R}}</script> has <script type="math/tex">n+1</script> continuous derivatives and <script type="math/tex">x_0 \in (a,b)</script>. Prove: <script type="math/tex">f^{(k)}(x_0) = 0</script> for all <script type="math/tex">k = 0, 1, 2, \ldots , n</script> if and only if <script type="math/tex">g(x) := \frac{f(x)}{{(x-x_0)}^{n+1}}</script> is continuous at <script type="math/tex">x_0</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000937">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.38</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">a,b,c \in {\mathbb {R}}</script> and <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> is differentiable, <script type="math/tex">f''(x) = a</script> for all <script type="math/tex">x</script>, <script type="math/tex">f'(0) = b</script>, and <script type="math/tex">f(0) = c</script>. Find <script type="math/tex">f</script> and prove that it is the unique differentiable function with this property. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000938">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.39</span>
<span class="thmtitle exercise_thmtitle">(Challenging)</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Show that a simple converse to Taylor’s theorem does not hold. Find a function <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> with no second derivative at <script type="math/tex">x=0</script> such that <script type="math/tex">\left\lvert {f(x)} \right\rvert  \leq \left\lvert {x^3} \right\rvert </script>, that is, <script type="math/tex">f</script> goes to zero at 0 faster than <script type="math/tex">x^3</script>, and while <script type="math/tex">f'(0)</script> exists, <script type="math/tex">f''(0)</script> does not. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:extendboundedder2">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.40</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Suppose <script type="math/tex">f \colon (0,1) \to {\mathbb {R}}</script> is differentiable and <script type="math/tex">f''</script> is bounded. 
</p>
<ol class="enumerate" id="a0000000939" style="list-style: none">
<li id="a0000000940" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		a)
	</span>
<p>
Show that there exists a once differentiable function <script type="math/tex">g \colon [0,1) \to {\mathbb {R}}</script> such that <script type="math/tex">f(x) = g(x)</script> for all <script type="math/tex">x \not= 0</script>. Hint: See <a href="#.">Exercise <span>4.30</span></a>. 
</p>
</li>
<li id="a0000000941" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		b)
	</span>
<p>
Find an example where the <script type="math/tex">g</script> is not twice differentiable at <script type="math/tex">x=0</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000942">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.41</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Prove the <em><script type="math/tex">n</script>th derivative test</em><a id="a0000000943" name="a0000000943"></a>. Suppose <script type="math/tex">n \in {\mathbb {N}}</script>, <script type="math/tex">x_0 \in (a,b)</script>, and <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> is <script type="math/tex">n</script> times continuously differentiable, with <script type="math/tex">f^{(k)}(x_0) = 0</script> for <script type="math/tex">k=1,2,\ldots ,n-1</script>, and <script type="math/tex">f^{(n)}(x_0) \not= 0</script>. Prove: 
</p>
<ol class="enumerate" id="a0000000944" style="list-style: none">
<li id="a0000000945" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		a)
	</span>
<p>
If <script type="math/tex">n</script> is odd, then <script type="math/tex">f</script> has neither a relative minimum, nor a maximum at <script type="math/tex">x_0</script>. 
</p>
</li>
<li id="a0000000946" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		b)
	</span>
<p>
If <script type="math/tex">n</script> is even, then <script type="math/tex">f</script> has a strict relative minimum at <script type="math/tex">x_0</script> if <script type="math/tex">f^{(n)}(x_0) > 0</script> and a strict relative maximum at <script type="math/tex">x_0</script> if <script type="math/tex">f^{(n)}(x_0) < 0</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000947">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.42</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Prove the more general version of the second derivative test. Suppose <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> is differentiable and <script type="math/tex">x_0 \in (a,b)</script> is such that, <script type="math/tex">f'(x_0) = 0</script>, <script type="math/tex">f''(x_0)</script> exists, and <script type="math/tex">f''(x_0) > 0</script>. Prove that <script type="math/tex">f</script> has a strict relative minimum at <script type="math/tex">x_0</script>. Hint: Consider the limit definition of <script type="math/tex">f''(x_0)</script>. 
</p>
</div>
</div>
</p>
<p>
<br/>
</p>
</section>
</section><section class="section">
<h2 id="sec:ift">4.4 Inverse function theorem</h2>
<section class="subsection">
<h3 id="a0000000948">4.4.1 Inverse function theorem</h3>
<p>
We start with a simple example. Consider the function <script type="math/tex">f(x) := a x</script> for a number <script type="math/tex">a \not= 0</script>. Then <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> is bijective, and the inverse is <script type="math/tex">f^{-1}(y) = \frac{1}{a} y</script>. In particular, <script type="math/tex">f'(x) = a</script> and <script type="math/tex">(f^{-1})'(y) = \frac{1}{a}</script>. As differentiable functions are “infinitesimally like” linear functions, we expect the same behavior from the inverse function. The main idea of differentiating inverse functions is the following lemma. 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="lemma:ift">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">4.26</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
 Let <script type="math/tex">I,J \subset {\mathbb {R}}</script> be intervals. If <script type="math/tex">f \colon I \to J</script> is strictly monotone (hence one-to-one), onto (<script type="math/tex">f(I) = J</script>), differentiable at <script type="math/tex">x_0 \in I</script>, and <script type="math/tex">f'(x_0) \not= 0</script>, then the inverse <script type="math/tex">f^{-1}</script> is differentiable at <script type="math/tex">y_0 = f(x_0)</script> and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  (f^{-1})’(y_0) = \frac{1}{f'\bigl ( f^{-1}(y_0) \bigr )} = \frac{1}{f'(x_0)} . \end{equation*}</script></span>
<p>
 If <script type="math/tex">f</script> is continuously differentiable and <script type="math/tex">f'</script> is never zero, then <script type="math/tex">f^{-1}</script> is continuously differentiable. 
</p>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000949">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
By <a href="#.">Proposition <span>3.67</span></a>, <script type="math/tex">f</script> has a continuous inverse. For convenience call the inverse <script type="math/tex">g \colon J \to I</script>. Let <script type="math/tex">x_0,y_0</script> be as in the statement. For <script type="math/tex">x \in I</script> write <script type="math/tex">y := f(x)</script>. If <script type="math/tex">x \not= x_0</script> and so <script type="math/tex">y \not= y_0</script>, we find 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{g(y)-g(y_0)}{y-y_0} = \frac{g\bigl (f(x)\bigr )-g\bigl (f(x_0)\bigr )}{f(x)-f(x_0)} = \frac{x-x_0}{f(x)-f(x_0)} . \end{equation*}</script></span>
<p>
 See <a href="#.">Figure <span>4.10</span></a> for the geometric idea. <figure id="inversefig">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0077.png" style="None"/>
  	<img src="../introduction_to_real/images/img-0079.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.10</span> <span class="caption_text">Interpretation of the derivative of the inverse function.</span>
</figcaption>
</div>
</figure>
</p>
<p>
Let 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  Q(x) := \begin{cases}  \frac{x-x_0}{f(x)-f(x_0)} &  \text{if } x \neq x_0, \\ \frac{1}{f'(x_0)} &  \text{if } x = x_0 \quad \text{(notice that } f’(x_0) \neq 0 \text{)}. \end{cases}\end{equation*}</script></span>
<p>
 As <script type="math/tex">f</script> is differentiable at <script type="math/tex">x_0</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \lim _{x \to x_0} Q(x) = \lim _{x \to x_0} \frac{x-x_0}{f(x)-f(x_0)} = \frac{1}{f'(x_0)} = Q(x_0) , \end{equation*}</script></span>
<p>
 that is, <script type="math/tex">Q</script> is continuous at <script type="math/tex">x_0</script>. As <script type="math/tex">g(y)</script> is continuous at <script type="math/tex">y_0</script>, the composition <script type="math/tex">Q\bigl (g(y)\bigr ) = \frac{g(y)-g(y_0)}{y-y_0}</script> is continuous at <script type="math/tex">y_0</script> by <a href="#.">Proposition <span>3.24</span></a>. Therefore, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  \frac{1}{f'\bigl (g(y_0)\bigr )} = Q\bigl (g(y_0)\bigr ) = \lim _{y \to y_0} Q\bigl (g(y)\bigr ) = \lim _{y \to y_0} \frac{g(y)-g(y_0)}{y-y_0} . \end{equation*}</script></span>
<p>
 So <script type="math/tex">g</script> is differentiable at <script type="math/tex">y_0</script> and <script type="math/tex">g'(y_0) = \frac{1}{f'\left(\vphantom {1^1_1}g(y_0)\right)}</script>. 
</p>
<p>
If <script type="math/tex">f'</script> is continuous and nonzero at all <script type="math/tex">x \in I</script>, then the lemma applies at all <script type="math/tex">x \in I</script>. As <script type="math/tex">g</script> is also continuous (it is differentiable), the derivative <script type="math/tex">g'(y) = \frac{1}{f'\left(\vphantom {1^1_1}g(y)\right)}</script> must be continuous. 
</p>
</div>
</div>
<p>
What is usually called the inverse function theorem is the following result. 
</p>
<p>
<div class="thmwrapper thm_thmwrapper" id="a0000000950">
<div class="thmheading thm_thmheading">
<span class="thmcaption thm_thmcaption">
    Theorem
    </span>
<span class="thmlabel thm_thmlabel">4.27</span>
<span class="thmtitle thm_thmtitle">(Inverse function theorem)</span>
</div>
<div class="thmcontent thm_thmcontent">
<p>
<a id="a0000000951" name="a0000000951"></a> Let <script type="math/tex">f \colon (a,b) \to {\mathbb {R}}</script> be a continuously differentiable function, <script type="math/tex">x_0 \in (a,b)</script> a point where <script type="math/tex">f'(x_0) \not= 0</script>. Then there exists an open interval <script type="math/tex">I \subset (a,b)</script> with <script type="math/tex">x_0 \in I</script>, the restriction <script type="math/tex">f|_{I}</script> is injective with a continuously differentiable inverse <script type="math/tex">g \colon J \to I</script> defined on an interval <script type="math/tex">J := f(I)</script>, and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  g’(y) = \frac{1}{f'\bigl ( g(y) \bigr )} \qquad \text{for all } y \in J. \end{equation*}</script></span>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000952">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
Without loss of generality, suppose <script type="math/tex">f'(x_0) > 0</script>. As <script type="math/tex">f'</script> is continuous, there must exist an open interval <script type="math/tex">I = (x_0-\delta ,x_0+\delta )</script> such that <script type="math/tex">f'(x) > 0</script> for all <script type="math/tex">x \in I</script>. See <a href="#.">Exercise <span>3.27</span></a>. 
</p>
<p>
By <a href="#.">Proposition <span>4.18</span></a>, <script type="math/tex">f</script> is strictly increasing on <script type="math/tex">I</script>, and hence the restriction <script type="math/tex">f|_{I}</script> is bijective onto <script type="math/tex">J: = f(I)</script>. As <script type="math/tex">f</script> is continuous, then by the <a href="#.">Corollary <span>3.64</span></a> (or directly via the <a href="#.">intermediate value theorem</a>) <script type="math/tex">f(I)</script> is in interval. Now apply <a href="#.">Lemma <span>4.26</span></a>. 
</p>
</div>
</div>
<p>
If you tried to prove the existence of roots directly as in <a href="#.">Example <span>1.14</span></a>, you saw how difficult that endeavor is. However, with the machinery we have built for inverse functions it becomes an almost trivial exercise, and with the lemma above we prove far more than mere existence. 
</p>
<p>
<div class="thmwrapper cor_thmwrapper" id="a0000000953">
<div class="thmheading cor_thmheading">
<span class="thmcaption cor_thmcaption">
    Corollary
    </span>
<span class="thmlabel cor_thmlabel">4.28</span>
</div>
<div class="thmcontent cor_thmcontent">
<p>
Given <script type="math/tex">n \in {\mathbb {N}}</script> and <script type="math/tex">x \geq 0</script> there exists a unique number <script type="math/tex">y \geq 0</script> (denoted <script type="math/tex">x^{1/n} := y</script>), such that <script type="math/tex">y^ n = x</script>. Furthermore, the function <script type="math/tex">g \colon (0,\infty ) \to (0,\infty )</script> defined by <script type="math/tex">g(x) := x^{1/n}</script> is continuously differentiable and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\begin{equation*}  g’(x) = \frac{1}{nx^{(n-1)/n}} = \frac{1}{n} \,  x^{(1-n)/n} , \end{equation*}</script></span>
<p>
 using the convention <script type="math/tex">x^{m/n} := {(x^{1/n})}^{m}</script>. 
</p>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000954">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
For <script type="math/tex">x=0</script> the existence of a unique root is trivial. 
</p>
<p>
Let <script type="math/tex">f \colon (0,\infty ) \to (0,\infty )</script> be defined by <script type="math/tex">f(y) := y^ n</script>. The function <script type="math/tex">f</script> is continuously differentiable and <script type="math/tex">f'(y) = ny^{n-1}</script>, see <a href="#.">Exercise <span>4.3</span></a>. For <script type="math/tex">y > 0</script> the derivative <script type="math/tex">f'</script> is strictly positive and so again by <a href="#.">Proposition <span>4.18</span></a>, <script type="math/tex">f</script> is strictly increasing (this can also be proved directly). Given any <script type="math/tex">M > 1</script>, <script type="math/tex">f(M) = M^ n \geq M</script>, and given any <script type="math/tex">1 > \epsilon > 0</script>, <script type="math/tex">f(\epsilon ) = \epsilon ^ n \leq \epsilon </script>. For every <script type="math/tex">x</script> with <script type="math/tex">\epsilon < x < M</script>, we have, by the <a href="#.">intermediate value theorem</a>, that <script type="math/tex">x \in f\bigl ( [\epsilon ,M] \bigr ) \subset f\bigl ( (0,\infty ) \bigr )</script>. As <script type="math/tex">M</script> and <script type="math/tex">\epsilon </script> were arbitrary, <script type="math/tex">f</script> is onto <script type="math/tex">(0,\infty )</script>, and hence <script type="math/tex">f</script> is bijective. Let <script type="math/tex">g</script> be the inverse of <script type="math/tex">f</script>, and we obtain the existence and uniqueness of positive <script type="math/tex">n</script>th roots. <a href="#.">Lemma <span>4.26</span></a> says <script type="math/tex">g</script> has a continuous derivative and <script type="math/tex">g'(x) = \frac{1}{f'\left(\vphantom {1^1_1}g(x)\right)} = \frac{1}{n {(x^{1/n})}^{n-1}}</script>. 
</p>
</div>
</div>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000955">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">4.29</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
The corollary provides a good example of where the inverse function theorem gives us an interval smaller than <script type="math/tex">(a,b)</script>. Take <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> defined by <script type="math/tex">f(x) := x^2</script>. Then <script type="math/tex">f'(x) \not= 0</script> as long as <script type="math/tex">x \not= 0</script>. If <script type="math/tex">x_0 > 0</script>, we can take <script type="math/tex">I=(0,\infty )</script>, but no larger. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000956">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">4.30</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
Another useful example is <script type="math/tex">f(x) := x^3</script>. The function <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> is one-to-one and onto, so <script type="math/tex">f^{-1}(y) = y^{1/3}</script> exists on the entire real line including zero and negative <script type="math/tex">y</script>. The function <script type="math/tex">f</script> has a continuous derivative, but <script type="math/tex">f^{-1}</script> has no derivative at the origin. The point is that <script type="math/tex">f'(0) = 0</script>. See <a href="#.">Figure <span>4.11</span></a> for a graph, notice the vertical tangent on the cube root at the origin. See also <a href="#.">Exercise <span>4.46</span></a>. <figure id="cubecuberootfig">
<div class="centered"><p>
<img src="../introduction_to_real/images/img-0081.png" style="None"/>
</p>
<figcaption>
<span class="caption_title">Figure</span><span class="caption_ref">4.11</span> <span class="caption_text">Graphs of <script type="math/tex">x^3</script> and <script type="math/tex">x^{1/3}</script>.</span>
</figcaption>
</div>
</figure>
</p>
</div>
</div>
</p>
</section><section class="subsection">
<h3 id="a0000000957">4.4.2 Exercises</h3>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000958">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.43</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> is continuously differentiable such that <script type="math/tex">f'(x) > 0</script> for all <script type="math/tex">x</script>. Show that <script type="math/tex">f</script> is invertible on the interval <script type="math/tex">J = f({\mathbb {R}})</script>, the inverse is continuously differentiable, and <script type="math/tex">{(f^{-1})}'(y) > 0</script> for all <script type="math/tex">y \in f({\mathbb {R}})</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000959">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.44</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">I,J</script> are intervals and a monotone onto <script type="math/tex">f \colon I \to J</script> has an inverse <script type="math/tex">g \colon J \to I</script>. Suppose you already know that both <script type="math/tex">f</script> and <script type="math/tex">g</script> are differentiable everywhere and <script type="math/tex">f'</script> is never zero. Using chain rule but not <a href="#.">Lemma <span>4.26</span></a> prove the formula <script type="math/tex">g'(y) = \frac{1}{f'\left(\vphantom {1_1^1}g(y)\right)}</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000960">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.45</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Let <script type="math/tex">n\in {\mathbb {N}}</script> be even. Prove that every <script type="math/tex">x > 0</script> has a unique negative <script type="math/tex">n</script>th root. That is, there exists a negative number <script type="math/tex">y</script> such that <script type="math/tex">y^ n = x</script>. Compute the derivative of the function <script type="math/tex">g(x) := y</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="exercise:oddroot">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.46</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Let <script type="math/tex">n \in {\mathbb {N}}</script> be odd and <script type="math/tex">n \geq 3</script>. Prove that every <script type="math/tex">x</script> has a unique <script type="math/tex">n</script>th root. That is, there exists a number <script type="math/tex">y</script> such that <script type="math/tex">y^ n = x</script>. Prove that the function defined by <script type="math/tex">g(x) := y</script> is differentiable except at <script type="math/tex">x=0</script> and compute the derivative. Prove that <script type="math/tex">g</script> is not differentiable at <script type="math/tex">x=0</script>. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000961">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.47</span>
<span class="thmtitle exercise_thmtitle">(requires <a href="#.">§<span>4.3</span></a>)</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
 Show that if in the inverse function theorem <script type="math/tex">f</script> has <script type="math/tex">k</script> continuous derivatives, then the inverse function <script type="math/tex">g</script> also has <script type="math/tex">k</script> continuous derivatives. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000962">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.48</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Let <script type="math/tex">f(x) := x + 2 x^2 \sin (\frac{1}{x})</script> for <script type="math/tex">x \not= 0</script> and <script type="math/tex">f(0) := 0</script>. Show that <script type="math/tex">f</script> is differentiable at all <script type="math/tex">x</script>, that <script type="math/tex">f'(0) > 0</script>, but that <script type="math/tex">f</script> is not invertible on any open interval containing the origin. 
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000963">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.49</span>
</div>
<div class="thmcontent exercise_thmcontent">
<ol class="enumerate" id="a0000000964" style="list-style: none">
<li id="a0000000965" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		a)
	</span>
<p>
Let <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> be a continuously differentiable function and <script type="math/tex">k > 0</script> be a number such that <script type="math/tex">f'(x) \geq k</script> for all <script type="math/tex">x \in {\mathbb {R}}</script>. Show <script type="math/tex">f</script> is one-to-one and onto, and has a continuously differentiable inverse <script type="math/tex">f^{-1} \colon {\mathbb {R}}\to {\mathbb {R}}</script>. 
</p>
</li>
<li id="a0000000966" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		b)
	</span>
<p>
Find an example <script type="math/tex">f \colon {\mathbb {R}}\to {\mathbb {R}}</script> where <script type="math/tex">f'(x) > 0</script> for all <script type="math/tex">x</script>, but <script type="math/tex">f</script> is not onto. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
<div class="thmwrapper exercise_thmwrapper" id="a0000000967">
<div class="thmheading exercise_thmheading">
<span class="thmcaption exercise_thmcaption">
    Exercise
    </span>
<span class="thmlabel exercise_thmlabel">4.50</span>
</div>
<div class="thmcontent exercise_thmcontent">
<p>
Suppose <script type="math/tex">I,J</script> are intervals and a monotone onto <script type="math/tex">f \colon I \to J</script> has an inverse <script type="math/tex">g \colon J \to I</script>. Suppose <script type="math/tex">x \in I</script> and <script type="math/tex">y := f(x) \in J</script>, and that <script type="math/tex">g</script> is differentiable at <script type="math/tex">y</script>. Prove: 
</p>
<ol class="enumerate" id="a0000000968" style="list-style: none">
<li id="a0000000969" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		a)
	</span>
<p>
If <script type="math/tex">g'(y) \not= 0</script>, then <script type="math/tex">f</script> is differentiable at <script type="math/tex">x</script>. 
</p>
</li>
<li id="a0000000970" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		b)
	</span>
<p>
If <script type="math/tex">g'(y) = 0</script>, then <script type="math/tex">f</script> is not differentiable at <script type="math/tex">x</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
</section>
</section>
<hr/>
<ol>
<li id="a0000000836">Named for the German mathematician <a href="https://en.wikipedia.org/wiki/Leibniz">Gottfried Wilhelm Leibniz</a> (1646–1716).</li>
<li id="a0000000868">Named after the French mathematician <a href="https://en.wikipedia.org/wiki/Michel_Rolle">Michel Rolle</a> (1652–1719).</li>
<li id="a0000000917">Named for the English mathematician <a href="https://en.wikipedia.org/wiki/Brook_Taylor">Brook Taylor</a> (1685–1731). It was first found by the Scottish mathematician <a href="https://en.wikipedia.org/wiki/James_Gregory_(mathematician)">James Gregory</a> (1638–1675). The statement we give was proved by <a href="https://en.wikipedia.org/wiki/Lagrange">Joseph-Louis Lagrange</a> (1736–1813)</li>
</ol>

            </div>
        </div>
    </div>

        </main>
		
		<footer class="text-muted">
	<hr>
	<div class="container">
		<div class="float-right">
			<ul style="list-style: none">
			<li><a href="#">Back to top</a></li>
			
			
			<li><a href="../introduction_to_real/pdf/the_derivative.pdf" target="_blank"><i class="fa fa-file-pdf-o"></i>&nbsp;Download as PDF</a></li>
			
			</ul>
		</div>
		<p>Generated using <a target="_blank" href="https://github.com/chirun-ncl/chirun">Chirun</a>, written by the E-Learning Unit, School of Mathematics &amp; Statistics, Newcastle University</p>
		<p>This page last generated: 2021-12-02</p>
	</div>
</footer>
		
    </body>
</html>
